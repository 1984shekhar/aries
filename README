This is the new Apache Aries site content
==========================================

Here is what I did to create it. Steps 1 and 2 should never need to br repeated so they are just here for reference.
Go straight to step 3 if you want to build the site and test it.

1) Branched the old site and created the new site structure as specififed on the cms pages:
http://www.apache.org/dev/cms.html, look under adoption constraints.

2) Extracted the cwiki content using the export-site.pl tool.
 To run this I had to install some extra perl modules:

   sudo port install p5-crypt-ssleay
   sudo port install  p5-libwww-perli
   sudo port install  p5-rpc-xml

These are Mac specific Darwin ports commands, these could also have been installed from CPAN.
For referece the CPAN links are here:

http://search.cpan.org/search?query=RPC%3AXML&mode=all  (RPC:XML)
http://search.cpan.org/~nanis/Crypt-SSLeay-0.58/SSLeay.pm (Crypt-SSLeay-0.58)
http://search.cpan.org/~gaas/libwww-perl-5.837/lib/LWP.pm (libwww-perl-5.837)

This generates the site content as *.mdtext files - but also leaves the *.cwiki files for reference.
The results of all of this are currently checked in here:
https://svn.apache.org/repos/asf/incubator/aries/branches/site/.

After the initial creation I had to (ARIES-502):
(a) Create a site template
(b) Workout how to fix the navigation panes (look at the templates directory)
(c) Fix a lot of places where the wiki conversion hadn't worked right
(d) In particular the downloads page - which we used to handle with a confluenece Macro

There is still more fixing up to be done!

At this point anyone should be able to check out, build and test the site. The tool used to build the site is
build_site.pl and can be found here: https://svn.apache.org/repos/infra/websites/cms/build/

3) To build the site using the build tools.

First check the cms build tools out of SVN.
To run the build_site.pl script I had to remove a library:

rm lib/Dotiac/DTL/Addon/markup.pl 

from the build tools directory.

And install two other libraries:
sudo perl -MCPAN -e "install Dotiac::DTL"
sudo cpan Dotiac::DTL::Addon::markup

Then to build the site use this command:

perl build_site.pl --source-base /path/to/newsite/trunk/ --target-base /path/to/output/

which will create *.html in /path/to/output/content

4) Check the site on a local server.

I use a vhost to check the site. On a Mac this means that I add the following stanza to /etc/apache2/extra/httpd-vhosts.conf

<VirtualHost *:80>
    DocumentRoot "/Users/zoe/Sites/zaries/www"
    ServerName zaries
    ErrorLog "/Users/zoe/Sites/zaries/error.log"
    CustomLog "/Users/zoe/Sites/zaries/access.log" custom

    LogLevel debug
</VirtualHost>

So to test the site I move it, like this:

mv /path/to/output/content /Users/zoe/Sites/zaries/www

Then navigate to http://zaries in a browser.




