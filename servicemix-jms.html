
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
<!--
    Pier's plugin always overwrites the stylesheet so lets explicitly use another one
    <link type="text/css" rel="stylesheet" href="autoexport:///SM/resources/space.css">
-->
    <LINK type="text/css" rel="stylesheet" href="resources/site.css">
    <SCRIPT src="resources/space.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://www.google-analytics.com/urchin.js" type="text/javascript">
    </SCRIPT>
    <SCRIPT type="text/javascript">
_uacct = "UA-398545-1";
urchinTracker();
    </SCRIPT>
    <TITLE>
servicemix-jms
    </TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">

    <!-- Banner -->
    <DIV id="site-banner">

      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" class="topbardiv" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/servicemix/images/logo.jpg">
          </TD>
          <TD align="right" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/images/apache-incubator-logo.png">
          </TD>
        </TR> 
      </TABLE>

    </DIV>

    <!-- Bread crumbs and Quick Links -->
    <DIV id="site-navbar">
      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" valign="middle" nowrap="">
            <DIV id="site-breadcrumbs">
<A href="home.html" title="ServiceMix">ServiceMix</A>&nbsp;&gt;&nbsp;<A href="home.html" title="Home">Home</A>&nbsp;&gt;&nbsp;<A href="documentation.html" title="Documentation">Documentation</A>&nbsp;&gt;&nbsp;<A href="components-list.html" title="Components list">Components list</A>&nbsp;&gt;&nbsp;<A href="jbi-components.html" title="JBI Components">JBI Components</A>&nbsp;&gt;&nbsp;<A href="" title="servicemix-jms">servicemix-jms</A>
            </DIV>
          </TD>
          <TD align="right" valign="middle" nowrap="">
            <DIV id="site-quicklinks">
<P><A href="download.html" title="Download">Download</A> &#124; <A href="documentation.html" title="Documentation">Documentation</A> &#124; <A href="javadocs.html" title="JavaDocs">JavaDocs</A> &#124; <A href="source.html" title="Source">Source</A> &#124; <SPAN class="nobr"><A href="home.html" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> &#124; <A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A> &#124; <A href="support.html" title="Support">Support</A></P>
            </DIV>
          </TD>
        </TR> 
      </TABLE>
    </DIV>

<!-- Integrate google search later.
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF- 8" />
            <input type="hidden" name="oe" value="UTF- 8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
-->

      <DIV id="site-content">
        <TABLE>
        <TR>
        <TD valign="top">
          <DIV id="site-navigation">
<H3><A name="Navigation-Overview"></A>Overview</H3>

<UL class="alternate" type="square">
	<LI><A href="home.html" title="Home">Home</A></LI>
	<LI><SPAN class="nobr"><A href="http://www.apache.org/" title="Visit page outside Confluence" rel="nofollow">ASF<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="license.html" title="License">License</A></LI>
	<LI><A href="faq.html" title="FAQ">FAQ</A></LI>
	<LI><A href="download.html" title="Download">Download</A></LI>
	<LI><A href="sitemap.html" title="SiteMap">SiteMap</A></LI>
</UL>


<H3><A name="Navigation-Community"></A>Community</H3>

<UL class="alternate" type="square">
	<LI><A href="users-guide.html" title="User's Guide">User&apos;s Guide</A></LI>
	<LI><A href="documentation.html" title="Documentation">Documentation</A></LI>
	<LI><A href="support.html" title="Support">Support</A></LI>
	<LI><A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A></LI>
	<LI><A href="mailing-lists.html" title="Mailing Lists">Mailing Lists</A></LI>
	<LI><SPAN class="nobr"><A href="http://issues.apache.org/activemq/browse/SM" title="Visit page outside Confluence" rel="nofollow">Issues<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="contributing.html" title="Contributing">Contributing</A></LI>
	<LI><SPAN class="nobr"><A href="http://goopen.org/confluence/pages/listpages-dirview.action?key=SM" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="team.html" title="Team">Team</A></LI>
	<LI><A href="users.html" title="Users">Users</A></LI>
</UL>


<H3><A name="Navigation-Developers"></A>Developers</H3>

<UL class="alternate" type="square">
	<LI><A href="source.html" title="Source">Source</A></LI>
	<LI><A href="building.html" title="Building">Building</A></LI>
	<LI><A href="ideas.html" title="Ideas">Ideas</A></LI>
	<LI><A href="becoming-a-committer.html" title="Becoming a committer">Becoming a committer</A></LI>
	<LI><A href="release-guide.html" title="Release Guide">Release Guide</A></LI>
	<LI><A href="related-projects.html" title="Related Projects">Related Projects</A></LI>
	<LI><A href="tools.html" title="Tools">Tools</A></LI>
	<LI><A href="resources.html" title="Resources">Resources</A></LI>
</UL>


<H3><A name="Navigation-Components"></A>Components</H3>

<UL class="alternate" type="square">
	<LI><A href="servicemix-bean.html" title="servicemix-bean">servicemix&#45;bean</A></LI>
	<LI><A href="servicemix-bpe.html" title="servicemix-bpe">servicemix&#45;bpe</A></LI>
	<LI><A href="servicemix-drools.html" title="servicemix-drools">servicemix&#45;drools</A></LI>
	<LI><A href="servicemix-eip.html" title="servicemix-eip">servicemix&#45;eip</A></LI>
	<LI><A href="servicemix-file.html" title="servicemix-file">servicemix&#45;file</A></LI>
	<LI><A href="servicemix-ftp.html" title="servicemix-ftp">servicemix&#45;ftp</A></LI>
	<LI><A href="servicemix-http.html" title="servicemix-http">servicemix&#45;http</A></LI>
	<LI><A href="" title="servicemix-jms">servicemix&#45;jms</A></LI>
	<LI><A href="servicemix-jsr181.html" title="servicemix-jsr181">servicemix&#45;jsr181</A></LI>
	<LI><A href="servicemix-lwcontainer.html" title="servicemix-lwcontainer">servicemix&#45;lwcontainer</A></LI>
	<LI><A href="servicemix-saxon.html" title="servicemix-saxon">servicemix&#45;saxon</A></LI>
	<LI><A href="servicemix-script.html" title="servicemix-script">servicemix&#45;script</A></LI>
	<LI><A href="servicemix-wsn2005.html" title="servicemix-wsn2005">servicemix&#45;wsn2005</A></LI>
	<LI><A href="servicemix-xmpp.html" title="servicemix-xmpp">servicemix&#45;xmpp</A></LI>
</UL>


          </DIV>
        </TD>
        <TD valign="top">
          <DIV id="site-page">

<!--          
            <div class="pagetitle">servicemix- jms</div>
-->
            <DIV class="wiki-content"><H1><A name="servicemix-jms-servicemixjms"></A>servicemix-jms</H1>

<P>ServiceMix ships with a JBI compliant JMS binding component named servicemix-jms.</P>

<P>Here are the main features:</P>
<UL>
	<LI>JBI compliant Binding Component</LI>
	<LI>Usable in a lightweight mode in servicemix.xml configuration files</LI>
	<LI>SOAP 1.1 and 1.2 support</LI>
	<LI>MIME attachments</LI>
	<LI>WS-Addressing support</LI>
	<LI>WSDL based and XBean based deployments</LI>
	<LI>Support for all MEPs as consumers or providers</LI>
</UL>


<H2><A name="servicemix-jms-Installation"></A>Installation</H2>

<P>Installing the servicemix-jms component can be done in several ways:</P>
<UL>
	<LI>drop the installer zip in an hotdeploy directory monitored by ServiceMix</LI>
	<LI>using <A href="ant-tasks.html" title="Ant Tasks">ant tasks</A></LI>
</UL>


<P>Note that when using ant tasks, the component is not started, you will have to start it manually using ant tasks or a console.</P>

<H2><A name="servicemix-jms-Configuration"></A>Configuration</H2>

<P>Several parameters can be configured using a JMX console.</P>
<TABLE cellpadding="5" width="85%" cellspacing="8px" class="infoMacro" border="0" align="center"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://goopen.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD><B class="strong">Configuration</B><BR>
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Name </TH>
<TH class="confluenceTh"> Type </TH>
<TH class="confluenceTh"> Description </TH>
<TH class="confluenceTh"> Default </TH>
</TR>
<TR>
<TD class="confluenceTd"> userName </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> UserName used to create a connection </TD>
<TD class="confluenceTd">&nbsp;</TD>
</TR>
<TR>
<TD class="confluenceTd"> password </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> Password used to create a connection </TD>
<TD class="confluenceTd">&nbsp;</TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiInitialContextFactory </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> Default JNDI InitialContext factory </TD>
<TD class="confluenceTd"> false </TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiProviderUrl </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> Default JNDI provider url </TD>
<TD class="confluenceTd">&nbsp;</TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiName </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> Default JNDI name to lookup the JMS ConnectionFactory </TD>
<TD class="confluenceTd">&nbsp;</TD>
</TR>
</TBODY></TABLE></TD></TR></TABLE>
<P>&nbsp;<BR>
&nbsp;</P>

<H2><A name="servicemix-jms-XBeandeployment"></A>XBean deployment</H2>

<P>You can deploy Service Units containing a file named xbean.xml for activating consumer and provider endpoints.</P>

<P>This xml file should respect the given syntax, though this is a spring based xml configuration file from where all beans of class <SPAN class="nobr"><A href="http://servicemix.org/maven/servicemix-jms/apidocs/org/apache/servicemix/jms/JmsEndpoint.html" title="Visit page outside Confluence" rel="nofollow">JmsEndpoint<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> are retrieved.<BR>
See a full example <SPAN class="nobr"><A href="http://svn.apache.org/repos/asf/incubator/servicemix/trunk/deployables/bindingcomponents/servicemix-jms/src/test/resources/xbean/xbean.xml" title="Visit page outside Confluence" rel="nofollow">here<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN>.&nbsp; Note that you have to define the jms namespace with</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;beans <SPAN class="code-keyword">xmlns:jms</SPAN>=<SPAN class="code-quote">&quot;http://servicemix.apache.org/jms/1.0&quot;</SPAN>&gt;</SPAN>
    ...
<SPAN class="code-tag">&lt;/beans&gt;</SPAN></PRE>
</DIV></DIV>
<P>Any numbers of endpoints can be specified in the xbean.xml file.</P>

<H3><A name="servicemix-jms-Consumerendpoint"></A>Consumer endpoint</H3>

<P>A consumer endpoint is a server-side http endpoint that will consumer plain JMS, or JMS+SOAP requests and send them into the NMR to a given JBI endpoint, which is called the proxied endpoint.</P>

<P>Following is an example of an jms consumer endpoint.</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml">&lt;jms:endpoint service=<SPAN class="code-quote">&quot;test:MyConsumerService&quot;</SPAN>
              endpoint=<SPAN class="code-quote">&quot;jms&quot;</SPAN>
              targetService=<SPAN class="code-quote">&quot;test:MyConsumerService&quot;</SPAN>
              targetEndpoint=<SPAN class="code-quote">&quot;myConsumer&quot;</SPAN>
              role=<SPAN class="code-quote">&quot;consumer&quot;</SPAN> 
              destinationStyle=<SPAN class="code-quote">&quot;queue&quot;</SPAN>
              jmsProviderDestinationName=<SPAN class="code-quote">&quot;queue/A&quot;</SPAN>
              jndiConnectionFactoryName=<SPAN class="code-quote">&quot;ConnectionFactory&quot;</SPAN>
              defaultMep=<SPAN class="code-quote">&quot;http://www.w3.org/2004/08/wsdl/in-out&quot;</SPAN>
              defaultOperation=<SPAN class="code-quote">&quot;test:Echo&quot;</SPAN> /&gt;</PRE>
</DIV></DIV>
<TABLE cellpadding="5" width="85%" cellspacing="8px" class="infoMacro" border="0" align="center"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://goopen.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD><B class="strong">Consumer endpoint attributes</B><BR>
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Name </TH>
<TH class="confluenceTh"> Type </TH>
<TH class="confluenceTh"> Description </TH>
<TH class="confluenceTh"> Required </TH>
</TR>
<TR>
<TD class="confluenceTd"> service </TD>
<TD class="confluenceTd"> QName </TD>
<TD class="confluenceTd"> the service name of the proxied endpoint </TD>
<TD class="confluenceTd"> yes </TD>
</TR>
<TR>
<TD class="confluenceTd"> endpoint </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the endpoint name of the proxied endpoint </TD>
<TD class="confluenceTd"> yes </TD>
</TR>
<TR>
<TD class="confluenceTd"> interfaceName </TD>
<TD class="confluenceTd"> QName </TD>
<TD class="confluenceTd"> the interface name of the proxied endpoint </TD>
<TD class="confluenceTd">&nbsp;</TD>
</TR>
<TR>
<TD class="confluenceTd"> targetService </TD>
<TD class="confluenceTd"> QName </TD>
<TD class="confluenceTd"> the service name of the target endpoint </TD>
<TD class="confluenceTd"> no (defaults to the service attribute) </TD>
</TR>
<TR>
<TD class="confluenceTd"> targetEndpoint </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the endpoint name of the target endpoint </TD>
<TD class="confluenceTd"> no (defaults to the endpoint attribute) </TD>
</TR>
<TR>
<TD class="confluenceTd"> targetInterfaceName </TD>
<TD class="confluenceTd"> QName </TD>
<TD class="confluenceTd"> the interface name of the target endpoint </TD>
<TD class="confluenceTd">&nbsp;</TD>
</TR>
<TR>
<TD class="confluenceTd"> role </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> must be &apos;consumer&apos; </TD>
<TD class="confluenceTd"> yes </TD>
</TR>
<TR>
<TD class="confluenceTd"> defaultMEP </TD>
<TD class="confluenceTd"> URI </TD>
<TD class="confluenceTd"> the default MEP uri to use </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> defaultOperation </TD>
<TD class="confluenceTd"> QName </TD>
<TD class="confluenceTd"> the default operation name to set on the JBI exchange. if not set, it defaults to the QName of the root xml element </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> soap </TD>
<TD class="confluenceTd"> boolean </TD>
<TD class="confluenceTd"> if set, the component will parse the soap requests and send the content into the NMR </TD>
<TD class="confluenceTd"> no (defaults to false) </TD>
</TR>
<TR>
<TD class="confluenceTd"> soapVersion </TD>
<TD class="confluenceTd"> string </TD>
<TD class="confluenceTd"> can be set to &apos;1.1&apos; to force the use of SOAP 1.1 messages </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> wsdlResource </TD>
<TD class="confluenceTd"> <SPAN class="nobr"><A href="http://springframework.org/docs/api/org/springframework/core/io/Resource.html" title="Visit page outside Confluence" rel="nofollow">Spring resource<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> </TD>
<TD class="confluenceTd"> if set, the wsdl will be retrieved from the given Spring resource </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> initialContextFactory </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the JNDI context factory class name </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiProviderURL </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the JNDI provide url </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> connectionFactory </TD>
<TD class="confluenceTd"> javax.jms.ConnectionFactory </TD>
<TD class="confluenceTd"> the connectionFactory to use.  This optional property can be used instead of using JNDI configuration </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiConnectionFactoryName </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the JNDI name of the JMS ConnectionFactory to lookup </TD>
<TD class="confluenceTd"> yes (unless a default one is provided on the jms component configuration) </TD>
</TR>
<TR>
<TD class="confluenceTd"> destination </TD>
<TD class="confluenceTd"> javax.jms.Destination </TD>
<TD class="confluenceTd"> the Destination to use. This optional property can be use instead of jndiDestinationName or jmsProviderDestinationName </TD>
<TD class="confluenceTd"> no (one of destination, jndiDestinationName or jmsProviderDestinationName) </TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiDestinationName </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the JNDI name of the destination to look up </TD>
<TD class="confluenceTd"> yes (unless destination or jmsProviderDestinationName is set) </TD>
</TR>
<TR>
<TD class="confluenceTd"> jmsProviderDestinationName </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> if used, the target JMS destination will be created by the JMS provider by calling Session.createQueue or Session.createTopic </TD>
<TD class="confluenceTd"> no (one of destination, jndiDestinationName or jmsProviderDestinationName) </TD>
</TR>
<TR>
<TD class="confluenceTd"> destinationStyle </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> used to select the destination type used with the jmsProviderDestinationName </TD>
<TD class="confluenceTd"> no (unless jmsProviderDestinationName is used) </TD>
</TR>
<TR>
<TD class="confluenceTd"> useMsgIdInResponse </TD>
<TD class="confluenceTd"> boolean </TD>
<TD class="confluenceTd"> true indicates that the JMS correlation id will be set to the id of the JMS request message; false indicates that an artificial correlation id will be used instead </TD>
<TD class="confluenceTd"> no (in this case the default behaviour is to use the message exchange id as the correlation id) </TD>
</TR>
</TBODY></TABLE></TD></TR></TABLE>
<P>The <B>targetService</B>, <B>targetEndpoint</B> and <B>targetInterfaceName</B> attributes can be used to specify the routing method to use (routing by interface, service or endpoint) and is also useful to allow several proxy endpoints to be created for the same JBI endpoint.  For example to create an JMS only endpoint and an JMS+SOAP endpoint, both jms endpoints will have the same targetEndpoint and targetService, but they must have different endpoint names.</P>

<H3><A name="servicemix-jms-Providerendpoint"></A>Provider endpoint</H3>

<P>A provider endpoint is a client-side jbi endpoint which can receive requests from the NMR and send them to a given url where the service is provided.</P>

<P>Here is an example of an jms provider endpoint:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml">&lt;jms:endpoint service=<SPAN class="code-quote">&quot;test:MyProviderService&quot;</SPAN>
              endpoint=<SPAN class="code-quote">&quot;myProvider&quot;</SPAN>
              role=<SPAN class="code-quote">&quot;provider&quot;</SPAN> 
              destinationStyle=<SPAN class="code-quote">&quot;queue&quot;</SPAN>
              jmsProviderDestinationName=<SPAN class="code-quote">&quot;queue/A&quot;</SPAN>
              jndiConnectionFactoryName=<SPAN class="code-quote">&quot;ConnectionFactory&quot;</SPAN>
              wsdlResource=<SPAN class="code-quote">&quot;classpath:provider.wsdl&quot;</SPAN> /&gt;</PRE>
</DIV></DIV>
<TABLE cellpadding="5" width="85%" cellspacing="8px" class="infoMacro" border="0" align="center"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://goopen.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD><B class="strong">Provider endpoint attributes</B><BR>
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh"> Name </TH>
<TH class="confluenceTh"> Type </TH>
<TH class="confluenceTh"> Description </TH>
<TH class="confluenceTh"> Required </TH>
</TR>
<TR>
<TD class="confluenceTd"> service </TD>
<TD class="confluenceTd"> QName </TD>
<TD class="confluenceTd"> the service name of the exposed jbi endpoint </TD>
<TD class="confluenceTd"> yes </TD>
</TR>
<TR>
<TD class="confluenceTd"> endpoint </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the endpoint name of the exposed jbi endpoint </TD>
<TD class="confluenceTd"> yes </TD>
</TR>
<TR>
<TD class="confluenceTd"> interfaceName </TD>
<TD class="confluenceTd"> QName </TD>
<TD class="confluenceTd"> the interface name of the exposed jbi endpoint </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> role </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> must be &apos;provider&apos; </TD>
<TD class="confluenceTd"> yes </TD>
</TR>
<TR>
<TD class="confluenceTd"> locationURI </TD>
<TD class="confluenceTd"> URI </TD>
<TD class="confluenceTd"> the http url of the target service </TD>
<TD class="confluenceTd"> yes </TD>
</TR>
<TR>
<TD class="confluenceTd"> soap </TD>
<TD class="confluenceTd"> boolean </TD>
<TD class="confluenceTd"> if set, the component will parse the soap requests and send the content into the NMR </TD>
<TD class="confluenceTd"> no (defaults to false) </TD>
</TR>
<TR>
<TD class="confluenceTd"> wsdlResource </TD>
<TD class="confluenceTd"> <SPAN class="nobr"><A href="http://springframework.org/docs/api/org/springframework/core/io/Resource.html" title="Visit page outside Confluence" rel="nofollow">Spring resource<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> </TD>
<TD class="confluenceTd"> if set, the wsdl will be retrieved from the given Spring resource </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> initialContextFactory </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the JNDI context factory class name </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiProviderURL </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the JNDI provide url </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> connectionFactory </TD>
<TD class="confluenceTd"> javax.jms.ConnectionFactory </TD>
<TD class="confluenceTd"> the connectionFactory to use.  This optional property can be used instead of using JNDI configuration </TD>
<TD class="confluenceTd"> no </TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiConnectionFactoryName </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the JNDI name of the JMS ConnectionFactory to lookup </TD>
<TD class="confluenceTd"> yes (unless a default one is provided on the jms component configuration) </TD>
</TR>
<TR>
<TD class="confluenceTd"> destination </TD>
<TD class="confluenceTd"> javax.jms.Destination </TD>
<TD class="confluenceTd"> the Destination to use. This optional property can be use instead of jndiDestinationName or jmsProviderDestinationName </TD>
<TD class="confluenceTd"> no (one of destination, jndiDestinationName or jmsProviderDestinationName) </TD>
</TR>
<TR>
<TD class="confluenceTd"> jndiDestinationName </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> the JNDI name of the destination to look up </TD>
<TD class="confluenceTd"> yes (unless destination or jmsProviderDestinationName is set) </TD>
</TR>
<TR>
<TD class="confluenceTd"> jmsProviderDestinationName </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> if used, the target JMS destination will be created by the JMS provider by calling Session.createQueue or Session.createTopic </TD>
<TD class="confluenceTd"> no (one of destination, jndiDestinationName or jmsProviderDestinationName) </TD>
</TR>
<TR>
<TD class="confluenceTd"> destinationStyle </TD>
<TD class="confluenceTd"> String </TD>
<TD class="confluenceTd"> used to select the destination type used with the jmsProviderDestinationName </TD>
<TD class="confluenceTd"> no (unless jmsProviderDestinationName is used) </TD>
</TR>
<TR>
<TD class="confluenceTd"> needJavaIdentifiers </TD>
<TD class="confluenceTd"> boolean </TD>
<TD class="confluenceTd"> (defaults to false) indicates that the jms provider does not support extented syntax for JMS properties and only support valid java identifiers.  In such a case, all non conformant properties will not be set on the JMS message. </TD>
</TR>
</TBODY></TABLE></TD></TR></TABLE>

<H3><A name="servicemix-jms-Processors"></A>Processors</H3>

<P>Several types of processors are defined to configure the behavior of servicemix-jms endpoints.  These are:</P>
<UL>
	<LI>multiplexing (default) is optimized for ActiveMQ</LI>
	<LI>standard which is best suited for other JMS providers</LI>
	<LI>jca can be used for transacted deliveries</LI>
</UL>


<P>The processor used on a given endpoint can be configured using the <TT>processorName</TT> attribute on the endpoint.</P>

<P>JCA enabled endpoints need specific configuration.  A full example is available <SPAN class="nobr"><A href="http://svn.apache.org/viewvc/incubator/servicemix/trunk/deployables/bindingcomponents/servicemix-jms/src/test/resources/org/apache/servicemix/jms/spring-jca.xml?revision=HEAD" title="Visit page outside Confluence" rel="nofollow">here<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></P>

<H3><A name="servicemix-jms-ConfiguringtheConnectionFactoryandDestination"></A>Configuring the ConnectionFactory and Destination</H3>


<H4><A name="servicemix-jms-JNDIconfiguration"></A>JNDI configuration</H4>

<P>When the ConnectionFactory or the Destination is lookup in JNDI, the JNDI context will be created in the following order:</P>
<UL>
	<LI>using the <B>initialContextFactory</B> and <B>jndiProviderURL</B></LI>
	<LI>using the <B>initialContextFactory</B> and <B>jndiProviderURL</B> configured on the component configuration</LI>
	<LI>using the default context provided by the JBI container</LI>
</UL>


<H4><A name="servicemix-jms-ConnectionFactory"></A>ConnectionFactory</H4>

<P>The JMS ConnectionFactory is retrieved using the properties defined on the endpoint in the following order:</P>
<UL>
	<LI>using <B>connectionFactory</B></LI>
	<LI>using <B>jndiConnectionFactoryName</B> to lookup the ConnectionFactory in JNDI</LI>
	<LI>using the <B>connectionFactory</B> configured on the component configuration</LI>
	<LI>using the <B>jndiConnectionFactoryName</B> configured on the component configuration to lookup the ConnectionFactory in JNDI</LI>
</UL>


<H4><A name="servicemix-jms-Destination"></A>Destination</H4>

<P>The JMS Destination is retrieved in the following order:</P>
<UL>
	<LI>using <B>destination</B></LI>
	<LI>using <B>jndiDestinationName</B></LI>
	<LI>using <B>jmsProviderDestinationName</B> and <B>destinationStyle</B></LI>
</UL>


<H4><A name="servicemix-jms-Examples"></A>Examples</H4>

<P>Using JNDI</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml">&lt;jms:endpoint ...
    jndiConnectionFactoryName=<SPAN class="code-quote">&quot;java:comp/env/jms/ConnectionFactory&quot;</SPAN>
    jndiDestinationName=<SPAN class="code-quote">&quot;java:comp/env/jms/MyQueue&quot;</SPAN> /&gt;</PRE>
</DIV></DIV>
<P>If you use ActiveMQ, you can use the following definition:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml">&lt;jms:endpoint ...
    connectionFactory=<SPAN class="code-quote">&quot;#connectionFactory&quot;</SPAN>
    destinationStyle=<SPAN class="code-quote">&quot;queue&quot;</SPAN>
    jmsProviderDestinationName=<SPAN class="code-quote">&quot;MyQueue&quot;</SPAN> /&gt;

<SPAN class="code-tag">&lt;bean id=<SPAN class="code-quote">&quot;connectionFactory&quot;</SPAN> class=<SPAN class="code-quote">&quot;org.apache.activemq.ActiveMQConnectionFactory&quot;</SPAN>&gt;</SPAN>
    <SPAN class="code-tag">&lt;property name=<SPAN class="code-quote">&quot;brokerURL&quot;</SPAN> value=<SPAN class="code-quote">&quot;tcp://localhost:61216&quot;</SPAN> /&gt;</SPAN>
<SPAN class="code-tag">&lt;/bean&gt;</SPAN></PRE>
</DIV></DIV>

<H2><A name="servicemix-jms-WSDLDeployment"></A>WSDL Deployment</H2>

<P>In addition to xbean based deployment, the component accepts WSDL-based deployment.<BR>
The service unit may contain any number of WSDL files, each one being parsed and activating the specified endpoints.<BR>
To retrieve the necessary informations from the wsdl, the component can recognize a jms extension to provide JNDI informations and a jbi extension which specifies the role of the component and the default MEP to use for JBI exchanges.</P>

<P>Here is an example of a WSDL:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml">&lt;definitions name=&apos;Echo&apos; 
             targetNamespace=&apos;http://jms.servicemix.org/Test&apos; 
             <SPAN class="code-keyword">xmlns:tns</SPAN>=&apos;http://jms.servicemix.org/Test&apos; 
             <SPAN class="code-keyword">xmlns:jms</SPAN>=&apos;http://servicemix.org/wsdl/jms/&apos; 
             xmlns=&apos;http://schemas.xmlsoap.org/wsdl/&apos;
             <SPAN class="code-keyword">xmlns:jbi</SPAN>=&apos;http://servicemix.org/wsdl/jbi/&apos;&gt;

    <SPAN class="code-tag">&lt;portType name=&apos;EchoInterface&apos;&gt;</SPAN>
    <SPAN class="code-tag">&lt;/portType&gt;</SPAN>

    <SPAN class="code-tag">&lt;binding name=&apos;EchoJmsBinding&apos; type=&apos;tns:EchoInterface&apos;&gt;</SPAN>
        <SPAN class="code-tag">&lt;jms:binding /&gt;</SPAN>
    <SPAN class="code-tag">&lt;/binding&gt;</SPAN>

    <SPAN class="code-tag">&lt;service name=&apos;Echo&apos;&gt;</SPAN>
        <SPAN class="code-tag">&lt;port name=&apos;EchoEndpoint&apos; binding=&apos;tns:EchoJmsBinding&apos;&gt;</SPAN>
            &lt;jms:address destinationStyle=<SPAN class="code-quote">&quot;queue&quot;</SPAN>
                         jmsProviderDestinationName=<SPAN class="code-quote">&quot;queue/A&quot;</SPAN>
                         jndiConnectionFactoryName=<SPAN class="code-quote">&quot;ConnectionFactory&quot;</SPAN>/&gt;
            &lt;jbi:endpoint role=<SPAN class="code-quote">&quot;consumer&quot;</SPAN>
                          defaultOperation=<SPAN class="code-quote">&quot;tns:Echo&quot;</SPAN>/&gt;
        <SPAN class="code-tag">&lt;/port&gt;</SPAN>
    <SPAN class="code-tag">&lt;/service&gt;</SPAN>
<SPAN class="code-tag">&lt;/definitions&gt;</SPAN></PRE>
</DIV></DIV>

<H2><A name="servicemix-jms-Lightweightmode"></A>Lightweight mode</H2>

<P>The servicemix-jms component can also be configured in a spring/xbean configuration file, for use in an embedded ServiceMix.<BR>
Here is an example of such a configuration:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;sm:activationSpec&gt;</SPAN>
  <SPAN class="code-tag">&lt;sm:component&gt;</SPAN>
    <SPAN class="code-tag">&lt;jms:component&gt;</SPAN>
      <SPAN class="code-tag">&lt;jms:endpoints&gt;</SPAN>
        &lt;jms:endpoint service=<SPAN class="code-quote">&quot;test:MyConsumerService&quot;</SPAN>
                      endpoint=<SPAN class="code-quote">&quot;myConsumer&quot;</SPAN>
                      role=<SPAN class="code-quote">&quot;consumer&quot;</SPAN> 
                      defaultMep=<SPAN class="code-quote">&quot;http://www.w3.org/2004/08/wsdl/in-out&quot;</SPAN>
                      destinationStyle=<SPAN class="code-quote">&quot;queue&quot;</SPAN>
                      jmsProviderDestinationName=<SPAN class="code-quote">&quot;queue/A&quot;</SPAN>
                      jndiConnectionFactoryName=<SPAN class="code-quote">&quot;jms/ConnectionFactory&quot;</SPAN> /&gt;

        &lt;jms:endpoint service=<SPAN class="code-quote">&quot;test:MyProviderService&quot;</SPAN>
                      endpoint=<SPAN class="code-quote">&quot;myProvider&quot;</SPAN>
                      role=<SPAN class="code-quote">&quot;provider&quot;</SPAN> 
                      destinationStyle=<SPAN class="code-quote">&quot;queue&quot;</SPAN>
                      jmsProviderDestinationName=<SPAN class="code-quote">&quot;queue/A&quot;</SPAN>
                      connectionFactory=<SPAN class="code-quote">&quot;#connectionFactory&quot;</SPAN> /&gt;
      <SPAN class="code-tag">&lt;/jms:endpoints&gt;</SPAN>
    <SPAN class="code-tag">&lt;/jms:component&gt;</SPAN>
  <SPAN class="code-tag">&lt;/sm:component&gt;</SPAN>
<SPAN class="code-tag">&lt;/sm:activationSpec&gt;</SPAN></PRE>
</DIV></DIV>
<TABLE cellpadding="5" width="85%" cellspacing="8px" class="warningMacro" border="0" align="center"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://goopen.org/confluence/images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD><B class="strong">Classpath issues when embedding servicemix-jms component</B><BR>
<P>When using the servicemix.xml configuration file to create jms endpoints, you must include the servicemix-jms-xxx.jar in your classpath.<BR>
You will find this file inside the component installer (./components/servicemix-jms-xxx.zip).<BR>
Failing this, an IllegalArgumentException will be thrown with the following message:<BR>
 Component name: xxxxxx is bound to an object which is not a JBI component, it is of type: javax.xml.namespace.QName</P></TD></TR></TABLE>

<H2><A name="servicemix-jms-AccessingWSDLs"></A>Accessing WSDLs</H2>

<P>WSDLs for consumer endpoints are retrieved using the following method:</P>
<UL>
	<LI>for a WSDL based deployed endpoint, the WSL will be used as is</LI>
	<LI>for an XBean based deployed endpoint, the WSDL will be retrieved from the wsdlResource attribute</LI>
	<LI>if this information is not provided, the component will try to generate a WSDL by retrieving the target endpoint WSDL and adding the relevant informations to it.</LI>
</UL>


<P>WSDLs are accessible on the MBean for the Endpoint using a JMX console.</P>

<H2><A name="servicemix-jms-WSAddressing"></A>WS-Addressing</H2>

<P>When used on a SOAP consumer endpoint, servicemix-jms handles the WS-Adressing Action and To headers.</P>

<H3><A name="servicemix-jms-wsa%3AAction"></A>wsa:Action</H3>

<P>The wsa:Action header can be used to specify the target interface name and operation to use for the JBI exchange.</P>

<P>The header uses the following syntax:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">[target namespace][delimiter][<SPAN class="code-keyword">interface</SPAN> name][delimiter][operation name]</PRE>
</DIV></DIV>
<P>where:</P>
<UL>
	<LI>[delimiter] is &quot;:&quot; when the [target namespace] is a URN, otherwise &quot;/&quot;.</LI>
	<LI>[target namespace] is the namespace of the interface.</LI>
	<LI>[interface name] is the name of the interface.</LI>
	<LI>[operation name] is the name of the operation.</LI>
</UL>


<P>For example, the following header</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;wsa:Action&gt;</SPAN>http://example.com/stockquote/StockQuoteInterface/GetLastTradePrice<SPAN class="code-tag">&lt;/wsa:Action&gt;</SPAN></PRE>
</DIV></DIV>
<P>will be used to address the JBI exchange with the following properties:</P>
<UL>
	<LI>interface name: {http://example.com/stockquote\}StockQuoteInterface</LI>
	<LI>operation name: {http://example.com/stockquote\}GetLastTradePrice</LI>
</UL>


<H3><A name="servicemix-jms-wsa%3ATo"></A>wsa:To</H3>

<P>The wsa:To header specifies the target JBI service name and endpoint name.</P>

<P>The header uses the following syntax:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">[target namespace][delimiter][service name][delimiter][endpoint name]</PRE>
</DIV></DIV>
<P>where:</P>
<UL>
	<LI>[delimiter] is &quot;:&quot; when the [target namespace] is a URN, otherwise &quot;/&quot;.</LI>
	<LI>[target namespace] is the namespace of the interface.</LI>
	<LI>[service name] is the name of the service.</LI>
	<LI>[endpoint name] is the name of the endpoint.</LI>
</UL>


<P>For example, the following header</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;wsa:To&gt;</SPAN>urn:example:stockquote:StockQuoteService:JBIEndpoint<SPAN class="code-tag">&lt;/wsa:To&gt;</SPAN></PRE>
</DIV></DIV>
<P>will be used to address the JBI exchange with the following properties:</P>
<UL>
	<LI>service name: {urn:example:stockquote}StockQuoteService</LI>
	<LI>endpoint name: JBIEndpoint</LI>
</UL>
</DIV>
          
                  </DIV>
        </TD>
      </TR>
      </TABLE>     
      </DIV>
    </DIV>
    <DIV id="site-footer">
          Added by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=gnt">gnt</A>,
    last edited by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=gnodet">Guillaume Nodet</A> on Dec 06, 2006
                  &nbsp;(<A href="http://goopen.org/confluence/pages/diffpages.action?pageId=1954&originalId=15203">view change</A>)
              
      (<A href="http://goopen.org/confluence/pages/editpage.action?pageId=1954">edit page</A>)
    </DIV>

  </BODY>

</HTML>