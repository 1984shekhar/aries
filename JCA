<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head profile="http://www.w3.org/2000/08/w3c-synd/#">
    <link rel="stylesheet" href="site.css" type="text/css"/>
    <title>ServiceMix - JCA</title>
</head>

<body>

  <table id="ulayout">
    <tr id="ulayout_top">
      <td colspan="2" valign="bottom">
        <table width="100%">
          <tr id="utop">
            <td id="utop_left">
              <a href="http://incubator.apache.org"><img src="http://incubator.apache.org/images/apache-incubator-logo.png" style="border: none;"/></a>
            </td>
            <td id="utop_right" style="text-align: right; vertical-align: middle;padding-right:10px;">
              <a href="http://incubator.apache.org/servicemix"><img src="images/logo.gif" alt="ServiceMix" class="spaceLogo" border="0"/></a>
            </td>
          </tr>
          <tr>
            <td colspan="2" id="uadvertising_top">
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td colspan="2">
        <table id="utop_nav">
          <tr>
            <td align="left" valign="middle">
              <div id="ubreadcrumbs">
                <p>
                  <a href="">Home</a>
                                     		                  </p>
              </div>
            </td>
            <td align="right" valign="middle">
              <div id="uquicklinks">
                                  <p><a href="Download" title="Download">Download</a> | <span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-core/apidocs/">JavaDocs</a></span> <span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-components/apidocs/">Components</a></span> | <a href="Source" title="Source">Source</a> | <span class="nobr"><a href="http://docs.codehaus.org/pages/listpages.action?key=SM">Wiki</a></span> |<span class="nobr"><a href="irc://irc.codehaus.org/servicemix">IRC</a></span> | <span class="nobr"><a href="http://servlet.uwyn.com/drone/log/hausbot/servicemix">IRC Log</a></span> | <a href="Mailing+Lists" title="Mailing Lists">Mailing Lists</a> | <a href="Discussion+Forums" title="Discussion Forums">Discussion Forums</a> | <span class="nobr"><a href="http://issues.apache.org/activemq/browse/SM">Support</a></span></p>
                              </div>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td colspan="2"></td>
    </tr>
    <tr id="ulayout_middle">
      <td id="uleft">
        <div class="content">
                      <div class="section_3"><h3><a name="Navigation-Overview"></a>Overview</h3>

<ul class="alternate" type="square">
	<li><a href="Home" title="Home">Home</a></li>
	<li><a href="Introduction+to+ESB" title="Introduction to ESB">Introduction to ESB</a></li>
	<li><a href="Background+to+ServiceMix" title="Background to ServiceMix">Background to ServiceMix</a></li>
	<li><a href="News" title="News">News</a></li>
	<li><a href="FAQ" title="FAQ">FAQ</a></li>
	<li><a href="Download" title="Download">Download</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Community"></a>Community</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://docs.codehaus.org/pages/listpages.action?key=SM">Wiki</a></span></li>
	<li><a href="Discussion+Forums" title="Discussion Forums">Discussion Forums</a></li>
	<li><a href="Mailing+Lists" title="Mailing Lists">Mailing Lists</a></li>
	<li><a href="Contributing" title="Contributing">Contributing</a></li>
	<li><a href="Team" title="Team">Team</a></li>
	<li><a href="Users" title="Users">Users</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Documentation"></a>Documentation</h3>

<ul class="alternate" type="square">
	<li><a href="Getting+Started" title="Getting Started">Getting Started</a></li>
	<li><a href="Running" title="Running">Running</a></li>
	<li><a href="Examples" title="Examples">Examples</a></li>
	<li><a href="Use+Cases" title="Use Cases">Use Cases</a></li>
	<li><a href="Configuration" title="Configuration">Configuration</a></li>
	<li><a href="Xml+Reference" title="Xml Reference">Xml Reference</a></li>
	<li><a href="Management" title="Management">Management</a></li>
	<li><a href="Architecture" title="Architecture">Architecture</a></li>
	<li><a href="Clustering" title="Clustering">Clustering</a></li>
	<li><a href="NMR+Flows" title="NMR Flows">NMR Flows</a></li>
	<li><a href="Articles" title="Articles">Articles</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Reference"></a>Reference</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://java.sun.com/integration/1.0/docs/sdk/api/index.html">JBI API</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-core/apidocs/">JavaDocs Core</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-components/apidocs/">JavaDocs Components</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-console/apidocs/">JavaDocs Console</a></span></li>
	<li><a href="Glossary" title="Glossary">Glossary</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Features"></a>Features</h3>

<ul class="alternate" type="square">
	<li><a href="Components" title="Components">Components</a></li>
	<li><a href="Routing" title="Routing">Routing</a></li>
	<li><a href="Transformation" title="Transformation">Transformation</a></li>
	<li><a href="Spring+Client+Toolkit" title="Spring Client Toolkit">Spring Client Toolkit</a></li>
	<li><a href="Client+API" title="Client API">Client API</a></li>
	<li><a href="POJO+support" title="POJO support">POJO support</a></li>
	<li><a href="Expressions" title="Expressions">Expressions</a></li>
	<li><a href="Component+helper+classes" title="Component helper classes">Component helper classes</a></li>
	<li><a href="Ant+Tasks" title="Ant Tasks">Ant Tasks</a></li>
	<li><a href="JMX+Console" title="JMX Console">JMX Console</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Integration"></a>Integration</h3>

<ul class="alternate" type="square">
	<li><a href="Spring+support" title="Spring support">Spring support</a></li>
	<li><a href="Geronimo+Integration" title="Geronimo Integration">Geronimo Integration</a></li>
	<li><a href="JBoss+Deployer" title="JBoss Deployer">JBoss Integration</a></li>
	<li><a href="Tomcat+Integration" title="Tomcat Integration">Tomcat Integration</a></li>
	<li><a href="JOnAS+Integration" title="JOnAS Integration">JOnAS Integration</a></li>
	<li><a href="JNDI+configuration" title="JNDI configuration">JNDI configuration</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-ServiceMixComponents"></a>ServiceMix Components</h3>

<ul class="alternate" type="square">
	<li><a href="BPEL" title="BPEL">BPEL</a></li>
	<li><a href="Cache" title="Cache">Cache</a></li>
	<li><a href="Drools" title="Drools">Drools</a></li>
	<li><a href="Email" title="Email">Email</a></li>
	<li><a href="File" title="File">File</a></li>
	<li><a href="FTP" title="FTP">FTP</a></li>
	<li><a href="Groovy" title="Groovy">Groovy</a></li>
	<li><a href="HTTP" title="HTTP">HTTP</a></li>
	<li><a href="Jabber" title="Jabber">Jabber</a></li>
	<li><a href="JAX+WS" title="JAX WS">JAX WS</a></li>
	<li><a href="JCA" title="JCA">JCA</a></li>
	<li><a href="JMS" title="JMS">JMS</a></li>
	<li><a href="Quartz" title="Quartz">Quartz</a></li>
	<li><a href="Reflection" title="Reflection">Reflection</a></li>
	<li><a href="RSS" title="RSS">RSS</a></li>
	<li><a href="SAAJ" title="SAAJ">SAAJ</a></li>
	<li><a href="Scripting" title="Scripting">Scripting</a></li>
	<li><a href="ServiceMix" title="ServiceMix">ServiceMix</a></li>
	<li><a href="Validation" title="Validation">Validation</a></li>
	<li><a href="XFire" title="XFire">XFire</a></li>
	<li><a href="XPath+Router" title="XPath Router">XPath Router</a></li>
	<li><a href="XSLT" title="XSLT">XSLT</a></li>
	<li><a href="XSQL" title="XSQL">XSQL</a></li>
	<li><a href="VFS" title="VFS">VFS</a></li>
	<li><a href="WSIF" title="WSIF">WSIF</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Tooling"></a>Tooling</h3>

<ul class="alternate" type="square">
	<li><a href="Visualisation" title="Visualisation">Visualisation</a></li>
	<li><a href="Eclipse+plugin" title="Eclipse plugin">Eclipse plugin</a></li>
	<li><a href="JBoss+Deployer" title="JBoss Deployer">JBoss Deployer</a></li>
	<li><a href="WAR+Deployment" title="WAR Deployment">WAR Deployment</a></li>
	<li><a href="Maven+JBI+plugin" title="Maven JBI plugin">Maven JBI plugin</a></li>
	<li><a href="Maven+SAR+plugin" title="Maven SAR plugin">Maven SAR plugin</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-OtherJBIsoftware"></a>Other JBI software</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://incubator.apache.org/projects/ode.html">Apache ODE</a></span></li>
	<li><span class="nobr"><a href="http://forge.objectweb.org/projects/celtix/">Celtix</a></span></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-RelatedProjects"></a>Related Projects</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://activemq.codehaus.org/">ActiveMQ</a></span></li>
	<li><span class="nobr"><a href="http://jencks.org/">Jencks</a></span></li>
	<li><span class="nobr"><a href="http://lingo.codehaus.org/">Lingo</a></span></li>
	<li><span class="nobr"><a href="http://activesoap.codehaus.org/">ActiveSOAP</a></span></li>
	<li><span class="nobr"><a href="http://www.springframework.org/">Spring</a></span></li>
	<li><span class="nobr"><a href="http://geronimo.apache.org/">Geronimo</a></span></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Support"></a>Support</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://issues.apache.org/activemq/browse/SM">Issues</a></span></li>
	<li><span class="nobr"><a href="http://issues.apache.org/activemq/browse/SM?report=com.atlassian.jira.plugin.system.project:roadmap-panel">Roadmap</a></span></li>
	<li><span class="nobr"><a href="http://issues.apache.org/activemq/browse/SM?report=com.atlassian.jira.plugin.system.project:changelog-panel">Change log</a></span></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Developers"></a>Developers</h3>

<ul class="alternate" type="square">
	<li><a href="Source" title="Source">Source</a></li>
	<li><a href="Roadmap" title="Roadmap">Roadmap</a></li>
	<li><a href="Ideas" title="Ideas">Ideas</a></li>
	<li><a href="Becoming+a+committer" title="Becoming a committer">Becoming a committer</a></li>
	<li><a href="Release+Guide" title="Release Guide">Release Guide</a></li>
	<li><span class="nobr"><a href="http://ci.codehaus.org/beetlejuice/viewProjectSummary.action?projectName=ServiceMix">BeetleJuice</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/clover/">Clover Report</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/xref/index.html">Source XRef</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/xref-test/index.html">Test Source XRef</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix.xsd.html">XSD</a></span></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Toolsweuse"></a>Tools we use</h3>

<p><span class="nobr"><a href="http://www.yourkit.com"><img src="http://incubator.apache.org/servicemix/download/attachments/25208/yourkit.jpg" align="absmiddle" border="0"/></a></span></p></div>
          
          <div class="section_3">
            <h3>Feeds</h3>
            <ul class="feedList">
              <li><a class="rss" href="http://docs.codehaus.org/spaces/rss.action?key=SM&amp;newPages=false">Site</a></li>
              <li><a class="rss" href="http://docs.codehaus.org/spaces/blogrss.action?key=SM">News</a></li>
            </ul>
          </div>
        </div>
      </td>
      <td id="umain">
        <div class="content">
          
          <div id="upage_title">JCA</div>
          <div id="uads">


<center>

</center>

          </div>
          <p>The JCA <span class="nobr"><a href="http://java.sun.com/j2ee/connector/">Java Connector Architecture</a></span> provides the most efficient way of thread pooling, resource pooling, transaction handling and consumption on JMS and other Resource Adapters. For example if you are consuming JMS messages, the JCA container provides the most efficient way of pooling the JMS sessions and connections, pooling threads and processing messages in parallel as well as transaction and exception handling.</p>

<p>ServiceMix provides JCA versions of its components for easy deployment in our <span class="nobr"><a href="http://jencks.org/">JCA Container</a></span>.</p>

<div class="section_2"><h2><a name="JCA-UsingJMSwithJCA"></a>Using JMS with JCA</h2>

<p>The most efficient way of consuming JMS is through JCA. This lets the JCA container handle the pooling of the session and connections, providing a way to efficiently process messages in parallel, as well as dealing with transactions and exception handling.</p>

<p>The steps to use JMS over JCA with ServiceMix are as follows.</p>

<div class="section_3"><h3><a name="JCA-ConfiguretheJCAContainer"></a>Configure the JCA Container</h3>

<p>Just add the following to your Spring configuration file</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;bean id=<span class="code-quote">"jencks"</span> class=<span class="code-quote">"org.jencks.JCAContainer"</span>&gt;</span>

  <span class="code-tag"><span class="code-comment">&lt;!-- lets use the default configuration of work manager and transaction manager--&gt;</span></span>
  <span class="code-tag">&lt;property name=<span class="code-quote">"bootstrapContext"</span>&gt;</span>
    <span class="code-tag">&lt;bean class=<span class="code-quote">"org.jencks.factory.BootstrapContextFactoryBean"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"threadPoolSize"</span> value=<span class="code-quote">"25"</span>/&gt;</span>
    <span class="code-tag">&lt;/bean&gt;</span>
  <span class="code-tag">&lt;/property&gt;</span>


  <span class="code-tag"><span class="code-comment">&lt;!-- the JCA Resource Adapter --&gt;</span></span>
  <span class="code-tag">&lt;property name=<span class="code-quote">"resourceAdapter"</span>&gt;</span>
    <span class="code-tag">&lt;bean id=<span class="code-quote">"activeMQResourceAdapter"</span> class=<span class="code-quote">"org.apache.activemq.ra.ActiveMQResourceAdapter"</span>&gt;</span>
      <span class="code-tag">&lt;property name=<span class="code-quote">"serverUrl"</span> value=<span class="code-quote">"tcp://localhost:61626"</span>/&gt;</span>
    <span class="code-tag">&lt;/bean&gt;</span>
  <span class="code-tag">&lt;/property&gt;</span>
<span class="code-tag">&lt;/bean&gt;</span></pre>
</div></div>
<p>&nbsp;</p>

<p>Which will create the JCA container. Notice that there is a work manager you can configure to set the thread pooling limits. Also you can associate whichever <em>JCA Resource Adapter</em> you wish, such as to use another JMS provider.</p>

</div><div class="section_3"><h3><a name="JCA-ConfiguretheJMSwithJCAcomponent."></a>Configure the JMS with JCA component.</h3>

<p>We have a JmsInUsingJCABinding which works nicely with our JCA container to provide a JBI component for consuming inbound JMS messages using JCA for all the session, connection and thread pooling as well as handling parallel processing of inbound messages and transaction handling.</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;sm:activationSpec componentName=<span class="code-quote">"myJmsReceiver"</span> service=<span class="code-quote">"foo:myJmsReceiver"</span> destinationService=<span class="code-quote">"foo:receiver"</span>&gt;</span>
  <span class="code-tag">&lt;sm:component&gt;</span><span class="code-tag">&lt;bean class=<span class="code-quote">"org.apache.servicemix.components.jms.JmsInUsingJCABinding"</span>&gt;</span>

    <span class="code-tag">&lt;property name=<span class="code-quote">"jcaContainer"</span> ref=<span class="code-quote">"jencks"</span>/&gt;</span>

    <span class="code-tag">&lt;property name=<span class="code-quote">"activationSpec"</span>&gt;</span>
      <span class="code-tag">&lt;bean class=<span class="code-quote">"org.apache.activemq.ra.ActiveMQActivationSpec"</span>&gt;</span>
        <span class="code-tag">&lt;property name=<span class="code-quote">"destination"</span> value=<span class="code-quote">"test.org.apache.servicemix.example.jca"</span>/&gt;</span>
        <span class="code-tag">&lt;property name=<span class="code-quote">"destinationType"</span> value=<span class="code-quote">"javax.jms.Topic"</span>/&gt;</span>
      <span class="code-tag">&lt;/bean&gt;</span>
    <span class="code-tag">&lt;/property&gt;</span>
  <span class="code-tag">&lt;/bean&gt;</span><span class="code-tag">&lt;/sm:component&gt;</span>
<span class="code-tag">&lt;/sm:activationSpec&gt;</span></pre>
</div></div>
<p>&nbsp;</p>

<p>You will notice that its not very different from the regular <a href="JMS" title="JMS">JMS</a> component; the main difference is the use of the J2EE activation spec object to register with the JCA container.</p>

<p>The activation specification is dependent on the JCA Resource Adapter being used. If you are using <span class="nobr"><a href="http://activemq.org/">ActiveMQ</a></span> as your resource adapter then here are all the <span class="nobr"><a href="http://activemq.codehaus.org/maven/multiproject/activemq-ra/apidocs/org/codehaus/activemq/ra/ActiveMQActivationSpec.html">various properties</a></span> you can configure, giving you full control over every aspect of the JMS subscription, pooling and delivery mode.</p>

</div></div><div class="section_2"><h2><a name="JCA-UsingXA"></a>Using XA</h2>

<p>To use XA for an inbound connection in the JCA container you'll need to specify a transaction manager to the connector. Here's an example</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;sm:activationSpec componentName=<span class="code-quote">"myJmsReceiver"</span> service=<span class="code-quote">"foo:myJmsReceiver"</span> destinationService=<span class="code-quote">"foo:receiver"</span>&gt;</span>
  <span class="code-tag">&lt;sm:component&gt;</span><span class="code-tag">&lt;bean class=<span class="code-quote">"org.apache.servicemix.components.jms.JmsInUsingJCABinding"</span>&gt;</span>

    <span class="code-tag">&lt;property name=<span class="code-quote">"jcaContainer"</span> ref=<span class="code-quote">"jencks"</span>/&gt;</span>

    <span class="code-tag">&lt;property name=<span class="code-quote">"activationSpec"</span>&gt;</span>
      <span class="code-tag">&lt;bean class=<span class="code-quote">"org.apache.activemq.ra.ActiveMQActivationSpec"</span>&gt;</span>
        <span class="code-tag">&lt;property name=<span class="code-quote">"destination"</span> value=<span class="code-quote">"test.org.apache.servicemix.example.jca"</span>/&gt;</span>
        <span class="code-tag">&lt;property name=<span class="code-quote">"destinationType"</span> value=<span class="code-quote">"javax.jms.Topic"</span>/&gt;</span>
      <span class="code-tag">&lt;/bean&gt;</span>
    <span class="code-tag">&lt;/property&gt;</span>

    <span class="code-tag"><span class="code-comment">&lt;!-- use XA transactions --&gt;</span></span>
    <span class="code-tag">&lt;property name=<span class="code-quote">"transactionManager"</span> ref=<span class="code-quote">"transactionManager"</span>/&gt;</span>
  <span class="code-tag">&lt;/bean&gt;</span><span class="code-tag">&lt;/sm:component&gt;</span>
<span class="code-tag">&lt;/sm:activationSpec&gt;</span></pre>
</div></div>
<p>&nbsp;</p>

<p>You also need to provide a transaction manager implementation to use. Here this exampe uses <span class="nobr"><a href="http://jencks.org/">Geronimo's Transaction Manager</a></span>.</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;bean id=<span class="code-quote">"transactionManager"</span> class=<span class="code-quote">"org.jencks.factory.TransactionManagerFactoryBean"</span>/&gt;</span></pre>
</div></div>
<p>&nbsp;</p></div>
        </div>
<div style="text-align: center; width: 100%; padding-top: 1cm;padding-bottom: 1cm">


</div>
</td>
    <tr>
    <tr id="ulayout_bottom">
      <td colspan="2" id="ufooter">
        <div class="content">
          
          
          <div>
            <a class="editPage" href="http://docs.codehaus.org/pages/editpage.action?spaceKey=SM&amp;title=JCA"><img src="http://www.codehaus.org/edit.gif" border="0">[&nbsp;edit&nbsp;]</a>
          </div>
        </div>
      </td>
    </tr>
  </table>
</html>
