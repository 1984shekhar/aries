
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
    <LINK type="text/css" rel="stylesheet" href="resources/site.css">
    <SCRIPT src="resources/space.js" type="text/javascript"></SCRIPT>
    <TITLE>
Importing ServiceMix into Eclipse
    </TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">

    <!-- Banner -->
    <DIV id="site-banner">
    </DIV>

      <DIV id="site-content">
        <TABLE>
        <TR>
        <TD valign="top">
          <DIV id="site-page">
            <DIV class="wiki-content"><H1><A name="ImportingServiceMixintoEclipse-Introduction"></A>Introduction</H1>

<P>This document will guide you through&nbsp;importing ServiceMix 3.0 into the IDE <SPAN class="nobr"><A href="http://download.eclipse.org/eclipse/downloads/" title="Visit page outside Confluence" rel="nofollow">Eclipse Java Development Tools<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> v3.x.</P>

<H2><A name="ImportingServiceMixintoEclipse-PreInstallationRequirements"></A>Pre-Installation Requirements</H2>

<P><B>Hardware:</B></P>
<UL>
	<LI>Around 25 MB of free disk space for the ServiceMix 3.x sources.</LI>
	<LI>Roughly 250 MB of free disk space for the complete build (Eclipse plugin and ServiceMix binaries) produced by Maven and further 200 MB for the dependencies Maven downloads during building. As a lot of small files are produced, the exact space demands depend greatly on your cluster utilisation ratio.</LI>
</UL>


<P><B>Operating Systems:</B></P>
<UL>
	<LI>Windows: Windows XP SP2, Windows 2000.</LI>
	<LI>Unix: Ubuntu Linux, Powerdog Linux, MacOS, AIX, HP-UX, Solaris, any Unix platform that supports Java.</LI>
</UL>


<P><B>Environment:</B></P>
<UL>
	<LI>Java Developer Kit (JDK) 1.5.x (Java 5) for compiling/building.</LI>
	<LI>The JAVA_HOME environment variable must be set to the directory where the JDK is installed, e.g., <TT>c:\Program Files\jsdk.1.5.x</TT></LI>
	<LI>Maven 2.0.4 or greater.</LI>
	<LI>Eclipse 3.x or greater.</LI>
</UL>


<H1><A name="ImportingServiceMixintoEclipse-ImportingServiceMix"></A>Importing ServiceMix</H1>

<P>Below are the steps to import ServiceMix as a project in Eclipse.</P>

<H2><A name="ImportingServiceMixintoEclipse-PreparingtheFilesforEclipse"></A>Preparing the Files for Eclipse</H2>

<OL>
	<LI>Grab the sources from <A href="../SM/source.html" title="Source">svn</A>or <SPAN class="nobr"><A href="http://servicemix.org/Download" title="Visit page outside Confluence" rel="nofollow">download<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> servicemix source distribution.
<BR clear="all"></LI>
	<LI>Open a command line and change to the source root folder. Execute the following Maven 2 command to ready the project for Eclipse. It will take around two minutes.
<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">mvn eclipse:eclipse</PRE>
</DIV></DIV>
<P>In case you did never use Maven before and get errors stating that some plugins or the like are missing, like for example:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">[INFO] Searching repository <SPAN class="code-keyword">for</SPAN> plugin with prefix: &apos;eclipse&apos;.
Downloading: http:<SPAN class="code-comment">//mirrors.sunsite.dk/maven2/org/apache/servicemix/tooling/jbi-maven-plugin/3.0-incubating/jbi-maven-plugin-3.0-incubating.jar
</SPAN>[WARNING] Unable to get resource from repository central (http:<SPAN class="code-comment">//repo1.maven.org/maven2)
</SPAN>[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Plugin could not be found - check that the goal name is correct: Unable to download the artifact from any repository</PRE>
</DIV></DIV>
<P>execute the commands stated under &quot;Build ServiceMix...&quot; in the chapters <A href="3-installation.html#3.Installation-WindowsSourceInstallation" title="Windows Source Installation on 3. Installation">Windows</A> / <A href="3-installation.html#3.Installation-UnixSourceInstallation" title="Unix Source Installation on 3. Installation">Unix</A> source installation:</P></LI>
</OL>


<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">mvn -Dprofile=step1
mvn -Dprofile=step2</PRE>
</DIV></DIV>
<P>and then retry.</P>

<H2><A name="ImportingServiceMixintoEclipse-InEclipse%3A"></A>In Eclipse:</H2>

<OL>
	<LI>From the &quot;File&quot; menu select &quot;Import&quot;.&nbsp;
<BR clear="all">
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/FileImport.JPG" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>&nbsp;Select &quot;Existing Projects into Workspace&quot; and click &quot;Next&quot;&nbsp;
<BR clear="all">
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Import.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>Browse for the root directory, which is the directory in which you downloaded ServiceMix.&nbsp; &quot;Select All&quot; the files in the Import pop-up window. They are probably already pre-selected for you (check box is checked).&nbsp; Un-checking the option &quot;Copy projects into workspace&quot; allows you to automatically always edit the current version of the SVN checkout folder, thus avoiding an import after each SVN update. Click &quot;Finish&quot; in the Import window; the import takes around three minutes.
<BR clear="all">
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Import_SelectAll.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>From the &quot;Windows&quot;&nbsp;menu and click &quot;Preferences&quot;<BR>
The Preferences window will pop-up.<BR>
Click on the &quot;Java&quot; plus sign and change to &quot;Compiler&quot;.<BR>
Compiler compliance level must be 5.0, pull down menu and select.<BR>
Check the &quot;Use default compliance settings&quot; box.&nbsp;
<BR clear="all">
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/JDK_Compliance.JPG" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>Then check under &quot;Installed JREs&quot; that you have JDK 5, e.g., jre_1.5.x&nbsp;
<BR clear="all">
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Installed_JREs.JPG" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>Click on &quot;Build Path&quot; and then select &quot;Classpath Variables&quot;.&nbsp;
<BR clear="all">
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Classpath_Variables.JPG" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>Click on &quot;New&quot; button to right
<BR clear="all">
A pop-up appears.<BR>
Enter the Name: M2_REPO<BR>
Enter the Path of your local maven repository, usually located in &lt;your home directory&gt;\.m2, for example:<BR>
C:\Documents and Settings\exjobb\.m2\repository
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/eclipse-m2-repo-variable.PNG" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>Click &quot;OK&quot; button. The necessary build takes around three minutes.</LI>
</OL>


<H1><A name="ImportingServiceMixintoEclipse-RunninganExample"></A>Running an Example</H1>

<P>Now you can run an example:</P>
<OL>
	<LI>In the Package Explorer find the Main class, which should be located in: servicemix-core/src/main/java/<BR>
under org.apache.servicemix/Main.java.<BR>
Double click on the main() method.&nbsp;
<BR clear="all">
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/PackageMainJava.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>From the Run menu select &quot;Run...&quot;&nbsp;
<BR clear="all">
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/RunRun.JPG" align="absmiddle" border="0"><BR clear="all">
&nbsp;</LI>
	<LI>You will get a Run window pop-up, from there select Java Application.
	<OL>
		<LI>Click on New button in botton left (Eclipse &lt;3.2) or the icon in the top left (Eclipse v3.2)</LI>
		<LI>Name the Project: any name you like, for example if you want to run the FilePoller / FileBinding application call it &quot;filepoller&quot;, so it&apos;s easy for you to remember what this run configuration does.</LI>
		<LI>Click on &quot;<B>Arguments</B>&quot; tab:
		<OL>
			<LI>In the &quot;Program Arguments&quot; box enter <TT>servicemix.xml</TT></LI>
			<LI>In the Working Directory enter the path of your example. Such as<BR>
S:\apache-servicemix\src\main\release\examples\file-binding<BR>
where S:\ is assumed as your servicemix root directory.<BR>
You can use the &quot;File System...&quot; button to browse for your directory.
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Run%20-%20filepoller%20-%20Arguments.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;
<BR clear="all"></LI>
		</OL>
		</LI>
		<LI>Click on the tab &quot;<B>Classpath</B>&quot; to give Eclipse needed information on where to search for executable files. This description sticks to the file-binding example, but a similar procedure will be needed for most examples and your own code as well. There are three main ways to add classes to the classpath:
		<OL>
			<LI>You can add other projects of the workbench. Doing this will make the file-binding example run.
			<OL>
				<LI>Click &quot;User Entries&quot;</LI>
				<LI>Click &quot;Add Projects&quot; and click the checkbox(es) in front of the project(s) that are required. For convenience reasons you may click &quot;Select All&quot;.
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Classpath%20-%20Add%20projects.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;
<BR clear="all"></LI>
				<LI>Click &quot;OK&quot;. Now your Run-dialog shall look similar to this screenshot:
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Classpath%20result%20all%20projects.png" align="absmiddle" border="0"><BR clear="all">
 &nbsp;</LI>
			</OL>
			</LI>
			<LI>You can add JARs and classes that are stored within a classpath environment variable. This is not required for the file-binding example, but possible, e.g. if you want to run a specific ServiceMix version from a JAR for bug reproduction or the like - this case is used for the following description. Often, this way is used to reference depenedencies Maven downloads automatically for you.
			<OL>
				<LI>Click &quot;User Entries&quot;</LI>
				<LI>Click &quot;Advanced&quot;, &quot;Add Classpath Variables&quot; and &quot;OK&quot;
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Classpath%20-%20Advanced%20Options%20var.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;
<BR clear="all"></LI>
				<LI>Check M2_REPRO and click &quot;Extend&quot;
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Classpath%20-%20Advanced%20Options%20-%20Variable.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;
<BR clear="all"></LI>
				<LI>Choose the JAR containing the bytecode for the missing classes. If you want to run SOME_VERSION of ServiceMix, choose /org/apache/servicemix/servicemix-core/SOME_VERSION/servicemix-core-SOME_VERSION.jar
<BR clear="all">
&nbsp;
<BR clear="all">
In case you want to reference a dependency, proceed in the same way. In case you do not know which package you shall select, see below.
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Classpath%20-%20Advanced%20Options%20-%20Variable%20-%20Extend.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;
<BR clear="all"></LI>
				<LI>Click &quot;OK&quot;</LI>
			</OL>
			</LI>
			<LI>You can add arbitrary folders to the classpath. This is usually only needed for your own code. To explain the workflow, let&apos;s assume you did not add any projects, thus your file-binding example does not run and the console window contains this message:
<DIV class="preformatted"><DIV class="preformattedContent">
<PRE>Error &apos;Bean class [org.apache.servicemix.components.file.FileWriter] not found&apos;
</PRE>
</DIV></DIV>
			<OL>
				<LI>Click &quot;User Entries&quot;</LI>
				<LI>Click &quot;Advanced&quot;, &quot;Add External Folder&quot; and &quot;OK&quot;
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Classpath%20-%20Advanced%20Options%20ext%20folder.png" align="absmiddle" border="0"><BR clear="all">
&nbsp;
<BR clear="all"></LI>
				<LI>When S:\ is your servicemix root directory, select/enter<BR>
<EM>S:\servicemix-components\target\classes</EM>
<BR clear="all">
&nbsp;
<BR clear="all">
Why this directory? Well, have a closer look at the error message presented above. The package <EM>org.apache.servicemix.components</EM> indicates the location of the missing bean <EM>FileWriter</EM> is <EM>servicemix-components</EM>, and as we need an executable file, the <EM>target\classes</EM> subdirectory is where to look. Of course we shall proof that <EM>FileWriter</EM> really is located here, so execute <EM>dir /s FileWriter.class</EM> in the given directory and watch the output.
<BR clear="all">
&nbsp;
<BR clear="all">  <IMG src="importing-servicemix-into-eclipse.data/Classpath%20-%20Advanced%20Options%20-%20external%20folder.png" align="absmiddle" border="0"><BR clear="all">
 &nbsp;</LI>
				<LI>Click &quot;OK&quot;.</LI>
			</OL>
			</LI>
		</OL>
		</LI>
	</OL>
	</LI>
	<LI>Click Apply.</LI>
	<LI>Click Run.</LI>
</OL>


<H2><A name="ImportingServiceMixintoEclipse-Troubleshooting"></A>Troubleshooting</H2>


<H3><A name="ImportingServiceMixintoEclipse-Oneortwolinesoferrormessages"></A>One or two lines of error messages</H3>

<P>In case you see an error message like</P>
<DIV class="preformatted"><DIV class="preformattedContent">
<PRE>java.lang.NoClassDefFoundError: org/apache/servicemix/Main
</PRE>
</DIV></DIV>
<P>in the console window, the ServiceMix class (or xbean or whatever is stated) file is not found. Did you add the class files to the classpath like stated above (see &quot;Add Projects&quot;)? In case you did, there may not exist any class files as they were not yet built. You can do that by executing</P>
<DIV class="preformatted"><DIV class="preformattedContent">
<PRE>mvn install
</PRE>
</DIV></DIV>
<P>in the source&apos;s root directory. This will take roughly 10 to 15 minutes. Maybe you prefer to reference a binary distribution (see &quot;Add Classpath Variables&quot; above).</P>

<H3><A name="ImportingServiceMixintoEclipse-Lengthyerrormessages%28stacktrace%29"></A>Lengthy error messages (stack trace)</H3>

<P>Scan the messages in the console window from top to bottom until you find one stating a missing component, indicated by a package name&nbsp;&#45; in case it&apos;s a &quot;<EM>java.lang.NoClassDefFoundError</EM>&quot; or &quot;<EM>java.lang.ClassNotFoundException</EM>&quot;, the missing class is printed directly after that error string, whereas for instance &quot;<EM>Error creating bean with name</EM>&quot; is demanding slightly more search.</P>

<P>Messages may look like one of the following</P>
<DIV class="preformatted"><DIV class="preformattedContent">
<PRE>Error &apos;Bean class [org.apache.servicemix.components.file.FileWriter] not found&apos;
</PRE>
</DIV></DIV>
<P>or&nbsp;</P>
<DIV class="preformatted"><DIV class="preformattedContent">
<PRE>java.lang.ClassNotFoundException: org.quartz.SimpleTrigger
</PRE>
</DIV></DIV>
<P>First extract the package name from the error message, so <EM>org.apache.servicemix.components</EM> respectivly <EM>org.quartz</EM> for the above examples.</P>

<P>Now, you have to choose the appropriate procedure:</P>
<UL>
	<LI>Build the class / project. See &quot;One or two lines of error messages&quot; above.</LI>
	<LI>Add the required library to the classpath like stated above for &quot;Add Classpath Variables&quot;. Look in the Maven repository for a folder matching the missing package. Sometimes the top level domain (org, com, de and the like) is omitted, so package <EM>org.quartz</EM> may be placed in folder <EM>quartz</EM>. Then choose a JAR containing executable bytecode classes, so not the <EM>quartz-1.5.1-sources.jar</EM> but <EM>quartz-1.5.1.jar</EM></LI>
	<LI>Add the required library to the classpath like stated above for &quot;Add External Folder&quot;. The package indicates the location of the missing bean <EM>FileWriter</EM> is <EM>servicemix-components</EM>, and as we need an executable file, the <EM>target\classes</EM> subdirectory is where to look. Of course we shall proof that <EM>FileWriter</EM> really is located here, so execute <EM>dir /s FileWriter.class</EM> in the given directory and watch the output.</LI>
</UL>


<P>Redo this until no class/JAR is missing any more.</P></DIV>
          </DIV>
        </TD>
      </TR>
      </TABLE>     
      </DIV>
    </DIV>
    <DIV id="site-footer">
          Added by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=georg_dembowski">Georg Dembowski</A>,
    last edited by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=georg_dembowski">Georg Dembowski</A> on Sep 19, 2006
                  &nbsp;(<A href="http://goopen.org/confluence/pages/diffpages.action?pageId=13740&originalId=13758">view change</A>)
                      <SPAN id="show" class="inline-control-link"><A href="" onclick="showComment(); return false;">show comment</A></SPAN>
        <SPAN id="hide" class="inline-control-link" style="display:none;"><A href="" onclick="hideComment(); return false;">hide comment</A></SPAN>
          <DIV id="versionComment" class="noteMacro" style="display:none; padding: 5px;">
      <B>Comment:</B>
      HDD space requirements refined. Deleted last section as Guillaume and me se no sense in using JAR instead of .class<BR>
      <SPAN class="smalltext"><A href="http://goopen.org/confluence/pages/viewpreviouspageversions.action?pageId=13740">View page history</A></SPAN>
  </DIV>

    <SCRIPT>
      var show = document.getElementById('show');
      var hide = document.getElementById('hide');
      var versionComment = document.getElementById('versionComment');

      function showComment(){
        show.style.display = 'none';
        hide.style.display = 'inline';
        versionComment.style.display = 'block';
      }

      function hideComment(){
        show.style.display = 'inline';
        hide.style.display = 'none';
        versionComment.style.display = 'none';
      }

    </SCRIPT>
    
      (<A href="http://goopen.org/confluence/pages/editpage.action?pageId=13740">edit page</A>)
    </DIV>

  </BODY>

</HTML>