
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
<!--
    Pier's plugin always overwrites the stylesheet so lets explicitly use another one
    <link type="text/css" rel="stylesheet" href="autoexport:///SM/resources/space.css">
-->
    <LINK type="text/css" rel="stylesheet" href="resources/site.css">
    <SCRIPT src="resources/space.js" type="text/javascript"></SCRIPT>
    <TITLE>
Working with Service Units
    </TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">

    <!-- Banner -->
    <DIV id="site-banner">

      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" class="topbardiv" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/servicemix/main/images/logo.jpg">
          </TD>
          <TD align="right" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/images/apache-incubator-logo.png">
          </TD>
        </TR> 
      </TABLE>

    </DIV>

    <!-- Bread crumbs and Quick Links -->
    <DIV id="site-navbar">
      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" valign="middle" nowrap="">
            <DIV id="site-breadcrumbs">
<A href="home.html" title="ServiceMix">ServiceMix</A>&nbsp;&gt;&nbsp;<A href="home.html" title="Home">Home</A>&nbsp;&gt;&nbsp;<A href="documentation.html" title="Documentation">Documentation</A>&nbsp;&gt;&nbsp;<A href="tooling-and-utilities.html" title="Tooling and Utilities">Tooling and Utilities</A>&nbsp;&gt;&nbsp;<A href="maven-jbi-plugin.html" title="Maven JBI plugin">Maven JBI plugin</A>&nbsp;&gt;&nbsp;<A href="" title="Working with Service Units">Working with Service Units</A>
            </DIV>
          </TD>
          <TD align="right" valign="middle" nowrap="">
            <DIV id="site-quicklinks">
<P><A href="download.html" title="Download">Download</A> &#124; <A href="documentation.html" title="Documentation">Documentation</A> &#124; <A href="javadocs.html" title="JavaDocs">JavaDocs</A> &#124; <A href="source.html" title="Source">Source</A> &#124; <SPAN class="nobr"><A href="home.html" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> &#124; <A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A> &#124; <A href="support.html" title="Support">Support</A></P>
            </DIV>
          </TD>
        </TR> 
      </TABLE>
    </DIV>

<!-- Integrate google search later.
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF- 8" />
            <input type="hidden" name="oe" value="UTF- 8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
-->

      <DIV id="site-content">
        <TABLE>
        <TR>
        <TD valign="top">
          <DIV id="site-navigation">
<H3><A name="Navigation-Overview"></A>Overview</H3>

<UL class="alternate" type="square">
	<LI><A href="home.html" title="Home">Home</A></LI>
	<LI><SPAN class="nobr"><A href="http://www.apache.org/" title="Visit page outside Confluence" rel="nofollow">ASF<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="license.html" title="License">License</A></LI>
	<LI><A href="faq.html" title="FAQ">FAQ</A></LI>
	<LI><A href="download.html" title="Download">Download</A></LI>
	<LI><A href="sitemap.html" title="SiteMap">SiteMap</A></LI>
</UL>


<H3><A name="Navigation-Community"></A>Community</H3>

<UL class="alternate" type="square">
	<LI><A href="../SM30UG/users-guide.html" title="User's Guide">User&apos;s Guide</A></LI>
	<LI><A href="documentation.html" title="Documentation">Documentation</A></LI>
	<LI><A href="support.html" title="Support">Support</A></LI>
	<LI><A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A></LI>
	<LI><A href="mailing-lists.html" title="Mailing Lists">Mailing Lists</A></LI>
	<LI><SPAN class="nobr"><A href="http://issues.apache.org/activemq/browse/SM" title="Visit page outside Confluence" rel="nofollow">Issues<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="contributing.html" title="Contributing">Contributing</A></LI>
	<LI><SPAN class="nobr"><A href="http://goopen.org/confluence/pages/listpages-dirview.action?key=SM" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="team.html" title="Team">Team</A></LI>
	<LI><A href="users.html" title="Users">Users</A></LI>
</UL>


<H3><A name="Navigation-Developers"></A>Developers</H3>

<UL class="alternate" type="square">
	<LI><A href="source.html" title="Source">Source</A></LI>
	<LI><A href="building.html" title="Building">Building</A></LI>
	<LI><A href="ideas.html" title="Ideas">Ideas</A></LI>
	<LI><A href="becoming-a-committer.html" title="Becoming a committer">Becoming a committer</A></LI>
	<LI><A href="release-guide.html" title="Release Guide">Release Guide</A></LI>
	<LI><A href="related-projects.html" title="Related Projects">Related Projects</A></LI>
	<LI><A href="tools.html" title="Tools">Tools</A></LI>
</UL>

          </DIV>
        </TD>
        <TD valign="top">
          <DIV id="site-page">

<!--          
            <div class="pagetitle">Working with Service Units</div>
-->
            <DIV class="wiki-content"><P>When you wish to deploy a component you can use a <B>Service Unit</B> to provide instance artifacts.  In JBI terms this means that a <B>Service Unit</B> can be defined to be provided to a component which will then be passed the contents of the SU.  The JBI is purposefully vague on the contents of an SU (other than the jbi.xml) since how you design your components to operate with &#42;Service Unit*s is up to you.</P>

<P>The Maven tooling provides some basic steps to allow you to build the <B>Service Unit*s,  which are simply zip files containing the resources you wish to pass to the component.  First you must change you pom.xml to package as a &#42;jbi-service-unit</B>.</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml">&lt;project xmlns=<SPAN class="code-quote">&quot;http://maven.apache.org/POM/4.0.0&quot;</SPAN> <SPAN class="code-keyword">xmlns:xsi</SPAN>=<SPAN class="code-quote">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
  xsi:schemaLocation=<SPAN class="code-quote">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;</SPAN>&gt;
  <SPAN class="code-tag">&lt;modelVersion&gt;</SPAN>4.0.0<SPAN class="code-tag">&lt;/modelVersion&gt;</SPAN>
  <SPAN class="code-tag">&lt;groupId&gt;</SPAN>org.apache.servicemix<SPAN class="code-tag">&lt;/groupId&gt;</SPAN>
  <SPAN class="code-tag">&lt;artifactId&gt;</SPAN>MyHttpServiceUnit<SPAN class="code-tag">&lt;/artifactId&gt;</SPAN>
  <SPAN class="code-tag">&lt;packaging&gt;</SPAN>jbi-service-unit<SPAN class="code-tag">&lt;/packaging&gt;</SPAN>
  <SPAN class="code-tag">&lt;version&gt;</SPAN>1.0-SNAPSHOT<SPAN class="code-tag">&lt;/version&gt;</SPAN>
  <SPAN class="code-tag">&lt;name&gt;</SPAN>A service unit<SPAN class="code-tag">&lt;/name&gt;</SPAN>
  ...
<SPAN class="code-tag">&lt;/project&gt;</SPAN></PRE>
</DIV></DIV>
<P>A <B>Service Unit</B> is assigned to a component and there are couple of ways you can do this using the tooling,  the best way to do this is to actually add the component as a dependency, as shown below for the ServiceMix HTTP component:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;dependencies&gt;</SPAN>
    <SPAN class="code-tag">&lt;dependency&gt;</SPAN>
       <SPAN class="code-tag">&lt;groupId&gt;</SPAN>org.apache.servicemix<SPAN class="code-tag">&lt;/groupId&gt;</SPAN>
       <SPAN class="code-tag">&lt;artifactId&gt;</SPAN>servicemix-http<SPAN class="code-tag">&lt;/artifactId&gt;</SPAN>
       <SPAN class="code-tag">&lt;version&gt;</SPAN>3.0-incubating-SNAPSHOT<SPAN class="code-tag">&lt;/version&gt;</SPAN>
    <SPAN class="code-tag">&lt;/dependency&gt;</SPAN>
<SPAN class="code-tag">&lt;/dependencies&gt;</SPAN></PRE>
</DIV></DIV>
<P>This is the preferred way,  since the tooling can later do some intelligent dependency calculations and actually find and install the components for you before installing the service assembly containing this service unit.  However,  if you are going to use a component that isn&apos;t available as a Maven dependency (is there such as thing I wonder?),  then you can use the project properties to define the component name.</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;properties&gt;</SPAN>
     <SPAN class="code-tag">&lt;componentName&gt;</SPAN>servicemix-http<SPAN class="code-tag">&lt;/componentName&gt;</SPAN>
<SPAN class="code-tag">&lt;/properties&gt;</SPAN></PRE>
</DIV></DIV>
<P>Once you have configured these steps you can run <EM>mvn install</EM> and you should find that both a jar and zip version of the service unit are created,  this is to allow you to reference the SU as a dependency on the Service Assembly.</P>

<P><EM>Remember that a Service Unit is pretty useless outside a</EM> <EM><A href="working-with-service-assemblies.html" title="Working with Service Assemblies"><EM>Service Assembly</EM></A></EM></P>

<P>The maven plugin will generate the ServiceUnit jbi descritor if the component contains a ServiceUnitAnalyzer.  In some cases, the ServiceUnitAnalyzer may fail to create the needed informations and generate an exception (if the service unit requires some runtime dependencies, such as JNDI objects for example).  When such a problem happen, you can disable the <TT>jbi.xml</TT> generation by using the following configuration:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">&lt;plugin&gt;
  &lt;groupId&gt;org.apache.servicemix.tooling&lt;/groupId&gt;
  &lt;artifactId&gt;jbi-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;1.0-incubating-SNAPSHOT&lt;/version&gt;
  &lt;extensions&gt;<SPAN class="code-keyword">true</SPAN>&lt;/extensions&gt;
  &lt;configuration&gt;
    &lt;useServiceUnitAnalyzer&gt;<SPAN class="code-keyword">false</SPAN>&lt;/useServiceUnitAnalyzer&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</PRE>
</DIV></DIV></DIV>
          
                  </DIV>
        </TD>
      </TR>
      </TABLE>     
      </DIV>
    </DIV>
    <DIV id="site-footer">
          Added by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=philip.dodds%2540gmail.com">Philip Dodds</A>,
    last edited by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=gnodet">Guillaume Nodet</A> on Oct 16, 2006
                  &nbsp;(<A href="http://goopen.org/confluence/pages/diffpages.action?pageId=8919&originalId=14118">view change</A>)
              
      (<A href="http://goopen.org/confluence/pages/editpage.action?pageId=8919">edit page</A>)
    </DIV>

  </BODY>

</HTML>