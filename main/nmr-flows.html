
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
<!--
    Pier's plugin always overwrites the stylesheet so lets explicitly use another one
    <link type="text/css" rel="stylesheet" href="autoexport:///SM/resources/space.css">
-->
    <LINK type="text/css" rel="stylesheet" href="resources/site.css">
    <SCRIPT src="resources/space.js" type="text/javascript"></SCRIPT>
    <TITLE>
NMR Flows
    </TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">

    <!-- Banner -->
    <DIV id="site-banner">

      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" class="topbardiv" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/servicemix/main/images/logo.jpg">
          </TD>
          <TD align="right" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/images/apache-incubator-logo.png">
          </TD>
        </TR> 
      </TABLE>

    </DIV>

    <!-- Bread crumbs and Quick Links -->
    <DIV id="site-navbar">
      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" valign="middle" nowrap="">
            <DIV id="site-breadcrumbs">
<A href="home.html" title="ServiceMix">ServiceMix</A>&nbsp;&gt;&nbsp;<A href="home.html" title="Home">Home</A>&nbsp;&gt;&nbsp;<A href="documentation.html" title="Documentation">Documentation</A>&nbsp;&gt;&nbsp;<A href="guides.html" title="Guides">Guides</A>&nbsp;&gt;&nbsp;<A href="" title="NMR Flows">NMR Flows</A>
            </DIV>
          </TD>
          <TD align="right" valign="middle" nowrap="">
            <DIV id="site-quicklinks">
<P><A href="download.html" title="Download">Download</A> &#124; <A href="documentation.html" title="Documentation">Documentation</A> &#124; <A href="javadocs.html" title="JavaDocs">JavaDocs</A> &#124; <A href="source.html" title="Source">Source</A> &#124; <SPAN class="nobr"><A href="home.html" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> &#124; <A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A> &#124; <A href="support.html" title="Support">Support</A></P>
            </DIV>
          </TD>
        </TR> 
      </TABLE>
    </DIV>

<!-- Integrate google search later.
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF- 8" />
            <input type="hidden" name="oe" value="UTF- 8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
-->

      <DIV id="site-content">
        <TABLE>
        <TR>
        <TD valign="top">
          <DIV id="site-navigation">
<H3><A name="Navigation-Overview"></A>Overview</H3>

<UL class="alternate" type="square">
	<LI><A href="home.html" title="Home">Home</A></LI>
	<LI><SPAN class="nobr"><A href="http://www.apache.org/" title="Visit page outside Confluence" rel="nofollow">ASF<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="license.html" title="License">License</A></LI>
	<LI><A href="faq.html" title="FAQ">FAQ</A></LI>
	<LI><A href="download.html" title="Download">Download</A></LI>
	<LI><A href="sitemap.html" title="SiteMap">SiteMap</A></LI>
</UL>


<H3><A name="Navigation-Community"></A>Community</H3>

<UL class="alternate" type="square">
	<LI><A href="users-guide.html" title="User's Guide">User&apos;s Guide</A></LI>
	<LI><A href="documentation.html" title="Documentation">Documentation</A></LI>
	<LI><A href="support.html" title="Support">Support</A></LI>
	<LI><A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A></LI>
	<LI><A href="mailing-lists.html" title="Mailing Lists">Mailing Lists</A></LI>
	<LI><SPAN class="nobr"><A href="http://issues.apache.org/activemq/browse/SM" title="Visit page outside Confluence" rel="nofollow">Issues<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="contributing.html" title="Contributing">Contributing</A></LI>
	<LI><SPAN class="nobr"><A href="http://goopen.org/confluence/pages/listpages-dirview.action?key=SM" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="team.html" title="Team">Team</A></LI>
	<LI><A href="users.html" title="Users">Users</A></LI>
</UL>


<H3><A name="Navigation-Developers"></A>Developers</H3>

<UL class="alternate" type="square">
	<LI><A href="source.html" title="Source">Source</A></LI>
	<LI><A href="building.html" title="Building">Building</A></LI>
	<LI><A href="ideas.html" title="Ideas">Ideas</A></LI>
	<LI><A href="becoming-a-committer.html" title="Becoming a committer">Becoming a committer</A></LI>
	<LI><A href="release-guide.html" title="Release Guide">Release Guide</A></LI>
	<LI><A href="related-projects.html" title="Related Projects">Related Projects</A></LI>
	<LI><A href="tools.html" title="Tools">Tools</A></LI>
	<LI><A href="resources.html" title="Resources">Resources</A></LI>
</UL>

          </DIV>
        </TD>
        <TD valign="top">
          <DIV id="site-page">

<!--          
            <div class="pagetitle">NMR Flows</div>
-->
            <DIV class="wiki-content"><P>ServiceMix allows for different message dispatch policies within the Normalized Message Router (NMR) Broker.<BR>
There are four basic types, that have different characteristics and are suited to different usage cases.</P>

<P>They are as follows:</P>

<H2><A name="NMRFlows-STFlow"></A>ST Flow</H2>

<P>Straight-through flow. A MessageExchange is routed straight to it&apos;s destination with no staging or buffering. A straight through flow is best suited for the cases where the ServiceMix JBIContainer is deployed with simple flows (no state) or embedded, or where latency needs to be as low as possible.</P>
<DIV class="panel" style="border-style: solid; border-color: #ccc; "><DIV class="panelHeader" style="border-bottom-style: solid; border-bottom-color: #ccc; "><B>ST Flow</B></DIV><DIV class="panelContent">
<P><IMG src="http://servicemix.org/stflow.jpg" align="absmiddle" border="0"></P>
</DIV></DIV>

<H2><A name="NMRFlows-SedaFlow"></A>Seda Flow</H2>

<P>The SedaFlow introduces a simple event staging between the internal processes in the NMR Broker. A Seda flow (the default) is suited for general deployment, as the additional staging is well suited buffering exchanges between heavily routed to components (where state may be being used) for example.</P>
<DIV class="panel" style="border-style: solid; border-color: #ccc; "><DIV class="panelHeader" style="border-bottom-style: solid; border-bottom-color: #ccc; "><B>Seda Flow</B></DIV><DIV class="panelContent">
<P><IMG src="http://servicemix.org/sedaflow.jpg" align="absmiddle" border="0"></P>
</DIV></DIV>

<H2><A name="NMRFlows-JMSFlow"></A>JMS Flow</H2>

<P>A JMS Flow is used for cases where you need collaboration between more than one ServiceMix JBIContainer (for fail-over or scalability).<BR>
Component deployment happens in the same way as a normal SericeMix JBI container (both for POJO and archive Component deployment) but all the containers in the cluster are notified of a deployment, and the JMS Flow will handle automatic routing (and failover) of MessageExchange(s) between the container instances.<BR>
A Message Queue is used for each JBI endpoint, so multiple instances of the same named Component will have requests load balanced across them.</P>
<DIV class="panel" style="border-style: solid; border-color: #ccc; "><DIV class="panelHeader" style="border-bottom-style: solid; border-bottom-color: #ccc; "><B>JMS Flow</B></DIV><DIV class="panelContent">
<P><IMG src="http://servicemix.org/clusterflow.jpg" align="absmiddle" border="0"></P>
</DIV></DIV>

<H2><A name="NMRFlows-JCAFlow"></A>JCA Flow</H2>

<P>The JCA Flow is very similar to the JMS Flow, in that it allow to cluster ServiceMix containers together.<BR>
The main difference is that it uses JCA to provide support for XA transactions when sending and receiving<BR>
JBI exchanges. You can find more informations on transactions <A href="transactions.html" title="Transactions">here</A>.</P>

<H2><A name="NMRFlows-Configuringflows"></A>Configuring flows</H2>

<P>Flows are configured on the JBI container by usually using the <B>flowNames</B> attribute on the main container element.</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;sm:container flowNames=<SPAN class="code-quote">&quot;seda&quot;</SPAN>&gt;</SPAN>
  ...
<SPAN class="code-tag">&lt;/sm:container&gt;</SPAN></PRE>
</DIV></DIV>
<P>JMS and JCA flows should be configured with an ActiveMQ url to the broker.</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;sm:container flowNames=<SPAN class="code-quote">&quot;jms?jmsURL=tcp://localhost:61616&quot;</SPAN>&gt;</SPAN>
  ...
<SPAN class="code-tag">&lt;/sm:container&gt;</SPAN></PRE>
</DIV></DIV>
<P>You can defined several flows by using a comma separated list.</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;sm:container flowNames=<SPAN class="code-quote">&quot;seda,jms?jmsURL=tcp://localhost:61616&quot;</SPAN>&gt;</SPAN>
  ...
<SPAN class="code-tag">&lt;/sm:container&gt;</SPAN></PRE>
</DIV></DIV>
<P>For more complex configurations, you can define the flow explicitely.</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;sm:container&gt;</SPAN>
  <SPAN class="code-tag">&lt;sm:flows&gt;</SPAN>
    <SPAN class="code-tag">&lt;sm:sedaFlow /&gt;</SPAN>
    &lt;sm:jcaFlow bootstrapContext=<SPAN class="code-quote">&quot;#bootstrapContext&quot;</SPAN>
                connectionManager=<SPAN class="code-quote">&quot;#connectionManager&quot;</SPAN>
                jmsURL=<SPAN class="code-quote">&quot;vm://localhost&quot;</SPAN> /&gt;
  <SPAN class="code-tag">&lt;/sm:flows&gt;</SPAN>
<SPAN class="code-tag">&lt;/sm:container&gt;</SPAN></PRE>
</DIV></DIV></DIV>
          
                  </DIV>
        </TD>
      </TR>
      </TABLE>     
      </DIV>
    </DIV>
    <DIV id="site-footer">
          Added by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=rajdavies">Rob Davies</A>,
    last edited by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=tdcox">Terry Cox</A> on Sep 01, 2006
                  &nbsp;(<A href="http://goopen.org/confluence/pages/diffpages.action?pageId=1986&originalId=13370">view change</A>)
              
      (<A href="http://goopen.org/confluence/pages/editpage.action?pageId=1986">edit page</A>)
    </DIV>

  </BODY>

</HTML>