
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
<!--
    Pier's plugin always overwrites the stylesheet so lets explicitly use another one
    <link type="text/css" rel="stylesheet" href="autoexport:///SM/resources/space.css">
-->
    <LINK type="text/css" rel="stylesheet" href="resources/site.css">
    <SCRIPT src="resources/space.js" type="text/javascript"></SCRIPT>
    <TITLE>
quartz-binding
    </TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">

    <!-- Banner -->
    <DIV id="site-banner">

      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" class="topbardiv" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/servicemix/main/images/logo.jpg">
          </TD>
          <TD align="right" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/images/apache-incubator-logo.png">
          </TD>
        </TR> 
      </TABLE>

    </DIV>

    <!-- Bread crumbs and Quick Links -->
    <DIV id="site-navbar">
      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" valign="middle" nowrap="">
            <DIV id="site-breadcrumbs">
<A href="home.html" title="ServiceMix">ServiceMix</A>&nbsp;&gt;&nbsp;<A href="home.html" title="Home">Home</A>&nbsp;&gt;&nbsp;<A href="documentation.html" title="Documentation">Documentation</A>&nbsp;&gt;&nbsp;<A href="example-use-cases.html" title="Example & Use Cases">Example &amp; Use Cases</A>&nbsp;&gt;&nbsp;<A href="examples.html" title="Examples">Examples</A>&nbsp;&gt;&nbsp;<A href="" title="quartz-binding">quartz-binding</A>
            </DIV>
          </TD>
          <TD align="right" valign="middle" nowrap="">
            <DIV id="site-quicklinks">
<P><A href="download.html" title="Download">Download</A> &#124; <A href="documentation.html" title="Documentation">Documentation</A> &#124; <A href="javadocs.html" title="JavaDocs">JavaDocs</A> &#124; <A href="source.html" title="Source">Source</A> &#124; <SPAN class="nobr"><A href="home.html" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> &#124; <A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A> &#124; <A href="support.html" title="Support">Support</A></P>
            </DIV>
          </TD>
        </TR> 
      </TABLE>
    </DIV>

<!-- Integrate google search later.
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF- 8" />
            <input type="hidden" name="oe" value="UTF- 8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
-->

      <DIV id="site-content">
        <TABLE>
        <TR>
        <TD valign="top">
          <DIV id="site-navigation">
<H3><A name="Navigation-Overview"></A>Overview</H3>

<UL class="alternate" type="square">
	<LI><A href="home.html" title="Home">Home</A></LI>
	<LI><SPAN class="nobr"><A href="http://www.apache.org/" title="Visit page outside Confluence" rel="nofollow">ASF<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="license.html" title="License">License</A></LI>
	<LI><A href="faq.html" title="FAQ">FAQ</A></LI>
	<LI><A href="download.html" title="Download">Download</A></LI>
	<LI><A href="sitemap.html" title="SiteMap">SiteMap</A></LI>
</UL>


<H3><A name="Navigation-Community"></A>Community</H3>

<UL class="alternate" type="square">
	<LI><A href="users-guide.html" title="User's Guide">User&apos;s Guide</A></LI>
	<LI><A href="documentation.html" title="Documentation">Documentation</A></LI>
	<LI><A href="support.html" title="Support">Support</A></LI>
	<LI><A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A></LI>
	<LI><A href="mailing-lists.html" title="Mailing Lists">Mailing Lists</A></LI>
	<LI><SPAN class="nobr"><A href="http://issues.apache.org/activemq/browse/SM" title="Visit page outside Confluence" rel="nofollow">Issues<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="contributing.html" title="Contributing">Contributing</A></LI>
	<LI><SPAN class="nobr"><A href="http://goopen.org/confluence/pages/listpages-dirview.action?key=SM" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="team.html" title="Team">Team</A></LI>
	<LI><A href="users.html" title="Users">Users</A></LI>
</UL>


<H3><A name="Navigation-Developers"></A>Developers</H3>

<UL class="alternate" type="square">
	<LI><A href="source.html" title="Source">Source</A></LI>
	<LI><A href="building.html" title="Building">Building</A></LI>
	<LI><A href="ideas.html" title="Ideas">Ideas</A></LI>
	<LI><A href="becoming-a-committer.html" title="Becoming a committer">Becoming a committer</A></LI>
	<LI><A href="release-guide.html" title="Release Guide">Release Guide</A></LI>
	<LI><A href="related-projects.html" title="Related Projects">Related Projects</A></LI>
	<LI><A href="tools.html" title="Tools">Tools</A></LI>
	<LI><A href="resources.html" title="Resources">Resources</A></LI>
</UL>

          </DIV>
        </TD>
        <TD valign="top">
          <DIV id="site-page">

<!--          
            <div class="pagetitle">quartz- binding</div>
-->
            <DIV class="wiki-content">
<H3><A name="quartz-binding-OverviewoftheServiceMix2.xQuartzExample"></A>Overview of the ServiceMix 2.x <EM>Quartz</EM> Example</H3>

<P>This document describes how to run the <EM>Quartz</EM> example in ServiceMix and provides details about what the Quartz example does. For information on the business use case, please refer to: <SPAN class="nobr"><A href="http://www.servicemix.org/Use%20Cases" title="Visit page outside Confluence" rel="nofollow">Use Case for Quartz<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN>.
<BR clear="all">
<BR clear="all">
The Quartz example illustrates the following:</P>
<UL>
	<LI>use of declarative programming</LI>
	<LI>how to use a <SPAN class="nobr"><A href="http://www.servicemix.org/Quartz" title="Visit page outside Confluence" rel="nofollow">Quartz<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> timer</LI>
	<LI>how to use tracing</LI>
</UL>


<P>The source code for the <EM>Quartz</EM> example is located in the ServiceMix installation directory under the <TT>examples\quartz-binding</TT> directory in the <TT>servicemix.xml</TT> file. It is recommended that you refer to the source code while reading this document.
<BR clear="all">
<BR clear="all">
This example shows how to use a Quartz component to set off a trigger, that sends messages to a trace component. The trace component logs the messages to the console as they arrive
<BR clear="all">
<BR clear="all"></P>
<H3><A name="quartz-binding-RunningtheQuartzExample"></A>Running the <EM>Quartz</EM> Example</H3>

<P>From a command shell, go to the Quartz example directory:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">cd [servicemix_install_dir]\examples\quartz-binding</PRE>
</DIV></DIV>
<P>Then type:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">[servicemix_install_dir]\bin\servicemix servicemix.xml</PRE>
</DIV></DIV>
<P>where <TT>servicemix_install_dir</TT> is the directory in which ServiceMix was installed.
<BR clear="all"></P>
<TABLE cellpadding="5" width="85%" cellspacing="8px" class="tipMacro" border="0" align="center"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://goopen.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD><B class="strong">Handy Hint</B><BR>
<P>Add <EM>$SERVICEMIX_HOME\bin</EM> directory to <EM>$PATH</EM> variable to simplify execution of the example.</P></TD></TR></TABLE>

<H3><A name="quartz-binding-StoppingtheQuartzExample"></A>Stopping the <EM>Quartz</EM> Example</H3>
<P>To terminate the Quartz example type &quot;CTRL-C&quot; in the command shell, in which it is running and answer &quot;y&quot; to the &quot;Terminate batch job (y/n)?&quot; question.
<BR clear="all"></P>

<H3><A name="quartz-binding-HowitWorks"></A>How it Works</H3>
<P>The diagram below illustrates the flow of messages through the <EM>Quartz</EM> components.
<BR clear="all">
<BR clear="all"></P>

<DIV class="panel" style="border-style: solid; border-color: #ccc; "><DIV class="panelHeader" style="border-bottom-style: solid; border-bottom-color: #ccc; "><B>Quartz Example Message Flow Diagram</B></DIV><DIV class="panelContent">
<P><DIV align="center"><IMG src="quartz-binding.data/quartzflow.jpg" border="0"></DIV></P>
</DIV></DIV>

<P><BR clear="all">
<BR clear="all"></P>

<P>Messages flow through the components as follows:</P>
<OL>
	<LI>Every 5 seconds the <EM>timer</EM> component sends a message to the <EM>trace</EM> component, through the Normalized Message Router (NMR).</LI>
	<LI>the <EM>trace</EM> component then transforms the normalized message into a string and logs it to the console.
<BR clear="all">
<BR clear="all">
<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">[INFO] TraceComponent - -Exchange: org.servicemix.jbi.messaging.InOnlyImpl@4fdf11 received IN message: 
org.servicemix.jbi.messaging.NormalizedMessageImpl@1be0369{properties: {org.servicemix.jms.message=ACTIVEMQ_TEXT_MESSAGE: 
id = 0 ActiveMQMessage{ , jmsMessageID = <SPAN class="code-keyword">null</SPAN>, bodyAsBytes = org.activemq.io.util.ByteArray@1d1fc02, 
readOnlyMessage = <SPAN class="code-keyword">true</SPAN>, jmsClientID = &apos;ID:Lisas-2828-1126207917359-23:0&apos; ,
 jmsCorrelationID = &apos;<SPAN class="code-keyword">null</SPAN>&apos; , jmsDestination = demo.org.servicemix.result, jmsReplyTo = <SPAN class="code-keyword">null</SPAN>, jmsDeliveryMode = 2, 
 jmsRedelivered = <SPAN class="code-keyword">false</SPAN>, jmsType = &apos;<SPAN class="code-keyword">null</SPAN>&apos; , jmsExpiration = 0, jmsPriority = 4, jmsTime
stamp = 1126207938593, properties = {}, readOnlyProperties = <SPAN class="code-keyword">true</SPAN>, entryBrokerName = &apos;ID:Lisas-2828-1126207917359-0:0&apos; , 
entryClusterName = &apos;<SPAN class="code-keyword">default</SPAN>&apos; , consumerNos = [0], transactionId = &apos;<SPAN class="code-keyword">null</SPAN>&apos; , xaTransacted = <SPAN class="code-keyword">false</SPAN>, 
consumerIdentifer = &apos;ID:Lisas-2828-1126207917359-14:0&apos; , messageConsumed = <SPAN class="code-keyword">false</SPAN>, transientConsumed = <SPAN class="code-keyword">true</SPAN>, 
sequenceNumber = 7, deliveryCount = 1, dispatchedFromDLQ = <SPAN class="code-keyword">false</SPAN>, messageAcknowledge = org.activemq.ActiveMQSession@1de7497,
jmsMessageIdentity = <SPAN class="code-keyword">null</SPAN>, producerKey = ID:Lisas-2828-1126207917359-29: }, text = &lt;?xml version=<SPAN class="code-quote">&quot;1.0&quot;</SPAN> encoding=<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>?&gt;
&lt;timer&gt;&lt;name&gt;My Example Job&lt;/name&gt;&lt;group&gt;ServiceMix&lt;/group&gt;&lt;fullname&gt;ServiceMix.My Example Job&lt;/fullname&gt;&lt;description/&gt;&lt;fireTime&gt;
Thu Sep 08 12:32:18 PDT 2005&lt;/fireTime&gt;&lt;/timer&gt;}}</PRE>
</DIV></DIV></LI>
</OL>




<H3><A name="quartz-binding-Details"></A>Details</H3>

<P>The following table provides more details about the function of each component and bean in the servicemix.xml file.
<BR clear="all">
<BR clear="all"></P>
<TABLE class="confluenceTable"><TBODY>
<TR>
<TH class="confluenceTh">Component or Bean ID</TH>
<TH class="confluenceTh">Description</TH>
</TR>
<TR>
<TD class="confluenceTd"><EM>timer</EM></TD>
<TD class="confluenceTd">The <EM>timer</EM> component shows the use of the QuartzComponent class. Every 5 seconds, until the program is terminated, the timer component kicks off an instance of a SimpleTrigger, which is associated with an instance of JobDetail. The job has a property called &quot;name&quot;, with a value of &quot;My Example Job&quot; and another property called &quot;group&quot;, with a value of &quot;ServiceMix.&quot; The resulting message is converted to a normalized message and then routed through the NMR. </TD>
</TR>
<TR>
<TD class="confluenceTd"><EM>trace</EM></TD>
<TD class="confluenceTd">Receives normalized messages via the NMR. It transforms the normalized message into a string and logs it to the console.</TD>
</TR>
</TBODY></TABLE>

<H3><A name="quartz-binding-Issues"></A>Issues</H3>
<P>The ServiceMix 2.0.2 distribution has a known logging bug, so output is not logged to the console, currently.  There are two ways to fix this problem. The first solution is to upgrade to 2.0.3 or greater. Please see <A href="download.html" title="Download">Download</A> for the latest releases. If 2.0.2 is still the latest/current release, then download a developer&apos;s release of 2.0.3.</P>

<P>The other solution is to replace the jencks-all-1.1.1.jar with the jencks-all-1.1.2.jar file. Note: This can only be done for the <B>source</B> version of ServiceMix 2.0.2. To apply the fix, perform the following steps:</P>
<OL>
	<LI>Download the jencks-all-1.2.jar <SPAN class="nobr"><A href="http://dist.codehaus.org/jencks/jars/jencks-all-1.1.2.jar" title="Visit page outside Confluence" rel="nofollow">here<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN>.</LI>
	<LI>Copy the jar file to [servicemix_src_install_dir]\assembly\target\servicemix-2.0.2\bin\servicemix-2.0.2\lib, where [servicemix_src_install_dir] is the directory in which the ServiceMix distribution is located.</LI>
	<LI>Delete jencks-all-1.1.1.jar from that directory.</LI>
	<LI>Place a copy of the jar file in the ServiceMix web directory  at [servicemix_src_install_dir]\servicemix-2.0.2\tooling\servicemix-web\target\servicemix-web\WEB-INF as well.</LI>
	<LI>To run the example in the source distribution:</LI>
</OL>


<DIV class="code"><DIV class="codeContent">
<PRE class="code-java">cd [servicemix_src_install_dir]\assembly\target\servicemix-2.0.2\bin\servicemix-2.0.2\bin

..\..\bin\servicemix servicemix.xml</PRE>
</DIV></DIV>

<P><B>NOTE:</B>  It is not necessary to build the source distribution if you have done so previously.  If ServiceMix has not been built, execute the steps above, before building.  The procedure on how to build the source distribution can be found <SPAN class="nobr"><A href="http://www.servicemix.org/Getting%20Started#GettingStarted-WindowsSourceInstallation" title="Visit page outside Confluence" rel="nofollow">here<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN>.</P>

<H3><A name="quartz-binding-RelatedDocumentation"></A>Related Documentation</H3>
<P>For more information on the following topics please see:</P>

<UL>
	<LI><SPAN class="nobr"><A href="http://www.servicemix.org/Quartz" title="Visit page outside Confluence" rel="nofollow">Quartz timer<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
</UL>


<P>For a brief explanation of the XML tags in the <TT>servicemix.xml</TT> file, please see:</P>

<UL>
	<LI><SPAN class="nobr"><A href="http://servicemix.codehaus.org/maven/servicemix.xsd.html" title="Visit page outside Confluence" rel="nofollow">XSD<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN>
<BR clear="all">
<BR clear="all"></LI>
</UL>




</DIV>
          
                  </DIV>
        </TD>
      </TR>
      </TABLE>     
      </DIV>
    </DIV>
    <DIV id="site-footer">
          Added by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=rajdavies">Rob Davies</A>,
    last edited by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=lmalgeri">Lisa Malgeri</A> on Dec 18, 2005
                  &nbsp;(<A href="http://goopen.org/confluence/pages/diffpages.action?pageId=2114&originalId=4090">view change</A>)
              
      (<A href="http://goopen.org/confluence/pages/editpage.action?pageId=2114">edit page</A>)
    </DIV>

  </BODY>

</HTML>