<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head profile="http://www.w3.org/2000/08/w3c-synd/#">
    <link rel="stylesheet" href="site.css" type="text/css"/>
    <title>ServiceMix - servicemix-eip</title>
</head>

<body>

  <table id="ulayout">
    <tr id="ulayout_top">
      <td colspan="2" valign="bottom">
        <table width="100%">
          <tr id="utop">
            <td id="utop_left">
              <a href="http://incubator.apache.org"><img src="http://incubator.apache.org/images/apache-incubator-logo.png" style="border: none;"/></a>
            </td>
            <td id="utop_right" style="text-align: right; vertical-align: middle;padding-right:10px;">
              <a href="http://incubator.apache.org/servicemix"><img src="images/logo.gif" alt="ServiceMix" class="spaceLogo" border="0"/></a>
            </td>
          </tr>
          <tr>
            <td colspan="2" id="uadvertising_top">
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td colspan="2">
        <table id="utop_nav">
          <tr>
            <td align="left" valign="middle">
              <div id="ubreadcrumbs">
                <p>
                  <a href="">Home</a>
                                     		                  </p>
              </div>
            </td>
            <td align="right" valign="middle">
              <div id="uquicklinks">
                                  <p><a href="Download" title="Download">Download</a> | <span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-core/apidocs/">JavaDocs</a></span> <span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-components/apidocs/">Components</a></span> | <a href="Source" title="Source">Source</a> | <span class="nobr"><a href="http://docs.codehaus.org/pages/listpages.action?key=SM">Wiki</a></span> |<span class="nobr"><a href="irc://irc.codehaus.org/servicemix">IRC</a></span> | <span class="nobr"><a href="http://servlet.uwyn.com/drone/log/hausbot/servicemix">IRC Log</a></span> | <a href="Mailing+Lists" title="Mailing Lists">Mailing Lists</a> | <a href="Discussion+Forums" title="Discussion Forums">Discussion Forums</a> | <span class="nobr"><a href="http://issues.apache.org/activemq/browse/SM">Support</a></span></p>
                              </div>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td colspan="2"></td>
    </tr>
    <tr id="ulayout_middle">
      <td id="uleft">
        <div class="content">
                      <div class="section_3"><h3><a name="Navigation-Overview"></a>Overview</h3>

<ul class="alternate" type="square">
	<li><a href="Home" title="Home">Home</a></li>
	<li><a href="Introduction+to+ESB" title="Introduction to ESB">Introduction to ESB</a></li>
	<li><a href="Background+to+ServiceMix" title="Background to ServiceMix">Background to ServiceMix</a></li>
	<li><a href="News" title="News">News</a></li>
	<li><a href="FAQ" title="FAQ">FAQ</a></li>
	<li><a href="Download" title="Download">Download</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Community"></a>Community</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://docs.codehaus.org/pages/listpages.action?key=SM">Wiki</a></span></li>
	<li><a href="Discussion+Forums" title="Discussion Forums">Discussion Forums</a></li>
	<li><a href="Mailing+Lists" title="Mailing Lists">Mailing Lists</a></li>
	<li><a href="Contributing" title="Contributing">Contributing</a></li>
	<li><a href="Team" title="Team">Team</a></li>
	<li><a href="Users" title="Users">Users</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Documentation"></a>Documentation</h3>

<ul class="alternate" type="square">
	<li><a href="Getting+Started" title="Getting Started">Getting Started</a></li>
	<li><a href="Running" title="Running">Running</a></li>
	<li><a href="Examples" title="Examples">Examples</a></li>
	<li><a href="Use+Cases" title="Use Cases">Use Cases</a></li>
	<li><a href="Configuration" title="Configuration">Configuration</a></li>
	<li><a href="Xml+Reference" title="Xml Reference">Xml Reference</a></li>
	<li><a href="Management" title="Management">Management</a></li>
	<li><a href="Architecture" title="Architecture">Architecture</a></li>
	<li><a href="Clustering" title="Clustering">Clustering</a></li>
	<li><a href="NMR+Flows" title="NMR Flows">NMR Flows</a></li>
	<li><a href="Articles" title="Articles">Articles</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Reference"></a>Reference</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://java.sun.com/integration/1.0/docs/sdk/api/index.html">JBI API</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-core/apidocs/">JavaDocs Core</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-components/apidocs/">JavaDocs Components</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix-console/apidocs/">JavaDocs Console</a></span></li>
	<li><a href="Glossary" title="Glossary">Glossary</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Features"></a>Features</h3>

<ul class="alternate" type="square">
	<li><a href="Components" title="Components">Components</a></li>
	<li><a href="Routing" title="Routing">Routing</a></li>
	<li><a href="Transformation" title="Transformation">Transformation</a></li>
	<li><a href="Spring+Client+Toolkit" title="Spring Client Toolkit">Spring Client Toolkit</a></li>
	<li><a href="Client+API" title="Client API">Client API</a></li>
	<li><a href="POJO+support" title="POJO support">POJO support</a></li>
	<li><a href="Expressions" title="Expressions">Expressions</a></li>
	<li><a href="Component+helper+classes" title="Component helper classes">Component helper classes</a></li>
	<li><a href="Ant+Tasks" title="Ant Tasks">Ant Tasks</a></li>
	<li><a href="JMX+Console" title="JMX Console">JMX Console</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Integration"></a>Integration</h3>

<ul class="alternate" type="square">
	<li><a href="Spring+support" title="Spring support">Spring support</a></li>
	<li><a href="Geronimo+Integration" title="Geronimo Integration">Geronimo Integration</a></li>
	<li><a href="JBoss+Deployer" title="JBoss Deployer">JBoss Integration</a></li>
	<li><a href="Tomcat+Integration" title="Tomcat Integration">Tomcat Integration</a></li>
	<li><a href="JOnAS+Integration" title="JOnAS Integration">JOnAS Integration</a></li>
	<li><a href="JNDI+configuration" title="JNDI configuration">JNDI configuration</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-ServiceMixComponents"></a>ServiceMix Components</h3>

<ul class="alternate" type="square">
	<li><a href="BPEL" title="BPEL">BPEL</a></li>
	<li><a href="Cache" title="Cache">Cache</a></li>
	<li><a href="Drools" title="Drools">Drools</a></li>
	<li><a href="Email" title="Email">Email</a></li>
	<li><a href="File" title="File">File</a></li>
	<li><a href="FTP" title="FTP">FTP</a></li>
	<li><a href="Groovy" title="Groovy">Groovy</a></li>
	<li><a href="HTTP" title="HTTP">HTTP</a></li>
	<li><a href="Jabber" title="Jabber">Jabber</a></li>
	<li><a href="JAX+WS" title="JAX WS">JAX WS</a></li>
	<li><a href="JCA" title="JCA">JCA</a></li>
	<li><a href="JMS" title="JMS">JMS</a></li>
	<li><a href="Quartz" title="Quartz">Quartz</a></li>
	<li><a href="Reflection" title="Reflection">Reflection</a></li>
	<li><a href="RSS" title="RSS">RSS</a></li>
	<li><a href="SAAJ" title="SAAJ">SAAJ</a></li>
	<li><a href="Scripting" title="Scripting">Scripting</a></li>
	<li><a href="ServiceMix" title="ServiceMix">ServiceMix</a></li>
	<li><a href="Validation" title="Validation">Validation</a></li>
	<li><a href="XFire" title="XFire">XFire</a></li>
	<li><a href="XPath+Router" title="XPath Router">XPath Router</a></li>
	<li><a href="XSLT" title="XSLT">XSLT</a></li>
	<li><a href="XSQL" title="XSQL">XSQL</a></li>
	<li><a href="VFS" title="VFS">VFS</a></li>
	<li><a href="WSIF" title="WSIF">WSIF</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Tooling"></a>Tooling</h3>

<ul class="alternate" type="square">
	<li><a href="Visualisation" title="Visualisation">Visualisation</a></li>
	<li><a href="Eclipse+plugin" title="Eclipse plugin">Eclipse plugin</a></li>
	<li><a href="JBoss+Deployer" title="JBoss Deployer">JBoss Deployer</a></li>
	<li><a href="WAR+Deployment" title="WAR Deployment">WAR Deployment</a></li>
	<li><a href="Maven+JBI+plugin" title="Maven JBI plugin">Maven JBI plugin</a></li>
	<li><a href="Maven+SAR+plugin" title="Maven SAR plugin">Maven SAR plugin</a></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-OtherJBIsoftware"></a>Other JBI software</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://incubator.apache.org/projects/ode.html">Apache ODE</a></span></li>
	<li><span class="nobr"><a href="http://forge.objectweb.org/projects/celtix/">Celtix</a></span></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-RelatedProjects"></a>Related Projects</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://activemq.codehaus.org/">ActiveMQ</a></span></li>
	<li><span class="nobr"><a href="http://jencks.org/">Jencks</a></span></li>
	<li><span class="nobr"><a href="http://lingo.codehaus.org/">Lingo</a></span></li>
	<li><span class="nobr"><a href="http://activesoap.codehaus.org/">ActiveSOAP</a></span></li>
	<li><span class="nobr"><a href="http://www.springframework.org/">Spring</a></span></li>
	<li><span class="nobr"><a href="http://geronimo.apache.org/">Geronimo</a></span></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Support"></a>Support</h3>

<ul class="alternate" type="square">
	<li><span class="nobr"><a href="http://issues.apache.org/activemq/browse/SM">Issues</a></span></li>
	<li><span class="nobr"><a href="http://issues.apache.org/activemq/browse/SM?report=com.atlassian.jira.plugin.system.project:roadmap-panel">Roadmap</a></span></li>
	<li><span class="nobr"><a href="http://issues.apache.org/activemq/browse/SM?report=com.atlassian.jira.plugin.system.project:changelog-panel">Change log</a></span></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Developers"></a>Developers</h3>

<ul class="alternate" type="square">
	<li><a href="Source" title="Source">Source</a></li>
	<li><a href="Roadmap" title="Roadmap">Roadmap</a></li>
	<li><a href="Ideas" title="Ideas">Ideas</a></li>
	<li><a href="Becoming+a+committer" title="Becoming a committer">Becoming a committer</a></li>
	<li><a href="Release+Guide" title="Release Guide">Release Guide</a></li>
	<li><span class="nobr"><a href="http://ci.codehaus.org/beetlejuice/viewProjectSummary.action?projectName=ServiceMix">BeetleJuice</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/clover/">Clover Report</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/xref/index.html">Source XRef</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/xref-test/index.html">Test Source XRef</a></span></li>
	<li><span class="nobr"><a href="http://servicemix.codehaus.org/maven/servicemix.xsd.html">XSD</a></span></li>
</ul>


</div><div class="section_3"><h3><a name="Navigation-Toolsweuse"></a>Tools we use</h3>

<p><span class="nobr"><a href="http://www.yourkit.com"><img src="http://incubator.apache.org/servicemix/download/attachments/25208/yourkit.jpg" align="absmiddle" border="0"/></a></span></p></div>
          
          <div class="section_3">
            <h3>Feeds</h3>
            <ul class="feedList">
              <li><a class="rss" href="http://docs.codehaus.org/spaces/rss.action?key=SM&amp;newPages=false">Site</a></li>
              <li><a class="rss" href="http://docs.codehaus.org/spaces/blogrss.action?key=SM">News</a></li>
            </ul>
          </div>
        </div>
      </td>
      <td id="umain">
        <div class="content">
          
          <div id="upage_title">servicemix-eip</div>
          <div id="uads">


<center>

</center>

          </div>
          <div class="section_1"><h1><a name="servicemix-eip-servicemixeip"></a>servicemix-eip</h1>

<p>The servicemix-eip component is a routing container where different routing patterns can be deployed as service unit.<br/>
This component is based on the great <span class="nobr"><a href="http://www.enterpriseintegrationpatterns.com/index.html">Enterprise Integration Patterns</a></span> book.</p>

<p>Supported patterns:</p>
<ul>
	<li>Content-Based Router</li>
	<li>Message Filter</li>
	<li>Pipeline</li>
	<li>Static Recipient List</li>
	<li>Static Routing Slip</li>
	<li>Wire Tap</li>
	<li>XPath Splitter</li>
</ul>


<p>In addition, this component can use all ServiceMix flows (including clustered and transactional flows), can be configured to be resilient to crashes and supports full fail-over to another node when clustered.</p>

<div class="section_2"><h2><a name="servicemix-eip-UsingservicemixeipasastandardJBIcomponent"></a>Using servicemix-eip as a standard JBI component</h2>


<div class="section_3"><h3><a name="servicemix-eip-Installation"></a>Installation</h3>

<p>Installing the servicemix-eip component can be done in several ways:</p>
<ul>
	<li>drop the installer zip in an hotdeploy directory monitored by ServiceMix</li>
	<li>using <a href="Ant+Tasks" title="Ant Tasks">ant tasks</a></li>
</ul>


<p>Note that when using ant tasks, the component is not started, you will have to start it manually using ant tasks or a console.</p>

</div><div class="section_3"><h3><a name="servicemix-eip-Configuration"></a>Configuration</h3>

<p>TODO: configure a persistent / clustered store</p>

</div><div class="section_3"><h3><a name="servicemix-eip-ServiceUnitpackaging"></a>Service Unit packaging</h3>

<p>Content of xbean.xml file to be packaged as a SU</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;beans <span class="code-keyword">xmlns:eip</span>=<span class="code-quote">"http://servicemix.apache.org/eip/1.0"</span>&gt;</span>

  ... add eip patterns here ...

<span class="code-tag">&lt;/beans&gt;</span></pre>
</div></div>

</div></div><div class="section_2"><h2><a name="servicemix-eip-UsingservicemixeipinaServiceMixxmlconfigurationfile"></a>Using servicemix-eip in a ServiceMix xml configuration file</h2>

<div class="code"><div class="codeContent">
<pre class="code-xml">&lt;beans <span class="code-keyword">xmlns:sm</span>=<span class="code-quote">"http://servicemix.apache.org/config/1.0"</span>
       <span class="code-keyword">xmlns:eip</span>=<span class="code-quote">"http://servicemix.apache.org/eip/1.0"</span>&gt;

  <span class="code-tag">&lt;sm:container ...&gt;</span>
    <span class="code-tag">&lt;sm:activationSpecs&gt;</span>
      <span class="code-tag">&lt;sm:activationSpec&gt;</span>
        <span class="code-tag">&lt;sm:component&gt;</span>
          <span class="code-tag">&lt;eip:component&gt;</span>
            <span class="code-tag">&lt;eip:endpoints&gt;</span>

              ... add eip patterns here ...

            <span class="code-tag">&lt;/eip:endpoints&gt;</span>
          <span class="code-tag">&lt;/eip:component&gt;</span>
        <span class="code-tag">&lt;/sm:component&gt;</span>
      <span class="code-tag">&lt;/sm:activationSpec&gt;</span>
      ...
    <span class="code-tag">&lt;/sm:activationSpecs&gt;</span>
  <span class="code-tag">&lt;/sm:container&gt;</span>
  ...

<span class="code-tag">&lt;/beans&gt;</span></pre>
</div></div>

</div><div class="section_2"><h2><a name="servicemix-eip-Patterns"></a>Patterns</h2>


<div class="section_3"><h3><a name="servicemix-eip-ContentBasedrouter"></a>Content-Based router</h3>

<p>ContentBasedRouter can be used for all kind of content-based routing.<br/>
This pattern implements the <span class="nobr"><a href="http://www.enterpriseintegrationpatterns.com/ContentBasedRouter.html">Content-Based Router</a></span> pattern.</p>

<div class="imageHolder"><img src="http://www.enterpriseintegrationpatterns.com/img/ContentBasedRouter.gif" align="absmiddle" border="0"/></div>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;eip:content-based-router service=<span class="code-quote">"test:router"</span> endpoint=<span class="code-quote">"endpoint"</span>&gt;</span>
  <span class="code-tag">&lt;eip:rules&gt;</span>
    <span class="code-tag">&lt;eip:routing-rule&gt;</span>
      <span class="code-tag">&lt;eip:predicate&gt;</span>
        <span class="code-tag">&lt;eip:xpath-predicate xpath=<span class="code-quote">"count(/test:echo) = 1"</span> namespaceContext=<span class="code-quote">"#nsContext"</span> /&gt;</span>
      <span class="code-tag">&lt;/eip:predicate&gt;</span>
      <span class="code-tag">&lt;eip:target&gt;</span>
        <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:pipeline"</span> /&gt;</span>
      <span class="code-tag">&lt;/eip:target&gt;</span>
    <span class="code-tag">&lt;/eip:routing-rule&gt;</span>
    <span class="code-tag">&lt;eip:routing-rule&gt;</span>
      <span class="code-tag"><span class="code-comment">&lt;!-- there is no predicate, so this is the default destination --&gt;</span></span>
      <span class="code-tag">&lt;eip:target&gt;</span>
        <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:recipients"</span> /&gt;</span>
      <span class="code-tag">&lt;/eip:target&gt;</span>
    <span class="code-tag">&lt;/eip:routing-rule&gt;</span>
  <span class="code-tag">&lt;/eip:rules&gt;</span>
<span class="code-tag">&lt;/eip:content-based-router&gt;</span></pre>
</div></div>

</div><div class="section_3"><h3><a name="servicemix-eip-MessageFilter"></a>Message Filter</h3>

<p>MessageFilter allows filtering incoming JBI exchanges.<br/>
This pattern implements the <span class="nobr"><a href="http://www.enterpriseintegrationpatterns.com/Filter.html">Message Filter</a></span> pattern.</p>

<div class="imageHolder"><img src="http://www.enterpriseintegrationpatterns.com/img/MessageFilter.gif" align="absmiddle" border="0"/></div>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;eip:message-filter service=<span class="code-quote">"test:messageFilter"</span> endpoint=<span class="code-quote">"endpoint"</span>&gt;</span>
  <span class="code-tag">&lt;eip:target&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:trace3"</span> /&gt;</span>
  <span class="code-tag">&lt;/eip:target&gt;</span>
  <span class="code-tag">&lt;eip:filter&gt;</span>
    <span class="code-tag">&lt;eip:xpath-predicate xpath=<span class="code-quote">"count(/test:world) = 1"</span> namespaceContext=<span class="code-quote">"#nsContext"</span>/&gt;</span>
  <span class="code-tag">&lt;/eip:filter&gt;</span>
<span class="code-tag">&lt;/eip:message-filter&gt;</span></pre>
</div></div>

</div><div class="section_3"><h3><a name="servicemix-eip-Pipeline"></a>Pipeline</h3>

<p>The Pipeline component is a bridge between an In-Only (or Robust-In-Only) MEP and an In-Out MEP.  When the Pipeline receives an In-Only MEP, it will send the input in an In-Out MEP to the tranformer destination and forward the response in an In-Only MEP to the target destination.</p>

<p>The old org.apache.servicemix.components.util.PipelineComponent will be deprecated.  This one offers the same feature but can be safely clustered and use in a transactional enviromnent.</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;eip:pipeline service=<span class="code-quote">"test:pipeline"</span> endpoint=<span class="code-quote">"endpoint"</span>&gt;</span>
  <span class="code-tag">&lt;eip:transformer&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:routingSlip"</span> /&gt;</span>
  <span class="code-tag">&lt;/eip:transformer&gt;</span>
  <span class="code-tag">&lt;eip:target&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:trace2"</span> /&gt;</span>
  <span class="code-tag">&lt;/eip:target&gt;</span>
<span class="code-tag">&lt;/eip:pipeline&gt;</span></pre>
</div></div>

</div><div class="section_3"><h3><a name="servicemix-eip-StaticRecipientList"></a>Static Recipient List</h3>

<p>The StaticRecipientList component will forward an input In-Only or Robust-In-Only exchange to a list of known recipients.<br/>
This component implements the <span class="nobr"><a href="http://www.enterpriseintegrationpatterns.com/RecipientList.html">Recipient List</a></span> pattern, with the limitation that the recipient list is static.</p>

<div class="imageHolder"><img src="http://www.enterpriseintegrationpatterns.com/img/RecipientList.gif" align="absmiddle" border="0"/></div>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;eip:static-recipient-list service=<span class="code-quote">"test:recipients"</span> endpoint=<span class="code-quote">"endpoint"</span>&gt;</span>
  <span class="code-tag">&lt;eip:recipients&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:messageFilter"</span> /&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:trace4"</span> /&gt;</span>
  <span class="code-tag">&lt;/eip:recipients&gt;</span>
<span class="code-tag">&lt;/eip:static-recipient-list&gt;</span></pre>
</div></div>

</div><div class="section_3"><h3><a name="servicemix-eip-StaticRoutingSlip"></a>Static Routing Slip</h3>

<p>A RoutingSlip component can be used to route an incoming In-Out exchange through a series of target services.<br/>
This component implements the <span class="nobr"><a href="http://www.enterpriseintegrationpatterns.com/RoutingTable.html">Routing Slip</a></span> pattern, with the limitation that the routing table is static.<br/>
This component only uses In-Out MEPs and errors or faults sent by targets are reported back to the consumer, thus interrupting the routing process.</p>

<div class="imageHolder"><img src="http://www.enterpriseintegrationpatterns.com/img/RoutingTableSimple.gif" align="absmiddle" border="0"/></div>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;eip:static-routing-slip service=<span class="code-quote">"test:routingSlip"</span> endpoint=<span class="code-quote">"endpoint"</span>&gt;</span>
  <span class="code-tag">&lt;eip:targets&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:echo"</span> /&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:echo"</span> /&gt;</span>
  <span class="code-tag">&lt;/eip:targets&gt;</span>
<span class="code-tag">&lt;/eip:static-routing-slip&gt;</span></pre>
</div></div>

</div><div class="section_3"><h3><a name="servicemix-eip-WireTap"></a>Wire Tap</h3>

<p>A WireTap component can be used to forward a copy of the input message to a listener.<br/>
This component implements the <span class="nobr"><a href="http://www.enterpriseintegrationpatterns.com/WireTap.html">WireTap</a></span> pattern.<br/>
It can handle all 4 standard MEPs, but will only send an In-Only MEP to the listener.</p>

<div class="imageHolder"><img src="http://www.enterpriseintegrationpatterns.com/img/WireTap.gif" align="absmiddle" border="0"/></div>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;eip:wire-tap service=<span class="code-quote">"test:wireTap"</span> endpoint=<span class="code-quote">"endpoint"</span>&gt;</span>
  <span class="code-tag">&lt;eip:target&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:xpathSplitter"</span> /&gt;</span>
  <span class="code-tag">&lt;/eip:target&gt;</span>
  <span class="code-tag">&lt;eip:inListener&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:trace1"</span> /&gt;</span>
  <span class="code-tag">&lt;/eip:inListener&gt;</span>
<span class="code-tag">&lt;/eip:wire-tap&gt;</span></pre>
</div></div>

</div><div class="section_3"><h3><a name="servicemix-eip-XPathSplitter"></a>XPath Splitter</h3>

<p>The XPathSplitter component implements the <span class="nobr"><a href="http://www.enterpriseintegrationpatterns.com/Sequencer.html">Splitter</a></span> pattern using an xpath expression to split the incoming xml.</p>

<div class="imageHolder"><img src="http://www.enterpriseintegrationpatterns.com/img/Sequencer.gif" align="absmiddle" border="0"/></div>
<div class="code"><div class="codeContent">
<pre class="code-xml">&lt;eip:xpath-splitter service=<span class="code-quote">"test:xpathSplitter"</span> endpoint=<span class="code-quote">"endpoint"</span> 
                    xpath=<span class="code-quote">"/*/*"</span> namespaceContext=<span class="code-quote">"#nsContext"</span>&gt;
  <span class="code-tag">&lt;eip:target&gt;</span>
    <span class="code-tag">&lt;eip:exchange-target service=<span class="code-quote">"test:router"</span> /&gt;</span>
  <span class="code-tag">&lt;/eip:target&gt;</span>
<span class="code-tag">&lt;/eip:xpath-splitter&gt;</span></pre>
</div></div>

</div></div><div class="section_2"><h2><a name="servicemix-eip-Tips"></a>Tips</h2>

<div class="section_3"><h3><a name="servicemix-eip-ExchangeTarget"></a>ExchangeTarget</h3>

<p>All patterns use the <b>&lt;exchange-target /&gt;</b> tag to specify the target of a JBI exchange.<br/>
This element has the following attributes:</p>
<table class="confluenceTable"><tbody>
<tr>
<th class="confluenceTh"> Name </th>
<th class="confluenceTh"> Type </th>
<th class="confluenceTh"> Description </th>
</tr>
<tr>
<td class="confluenceTd"> interface </td>
<td class="confluenceTd"> QName </td>
<td class="confluenceTd"> the QName of the target interface. One of service or interface attribute is required </td>
</tr>
<tr>
<td class="confluenceTd"> operation </td>
<td class="confluenceTd"> QName </td>
<td class="confluenceTd"> the QName of the target operation (optional)</td>
</tr>
<tr>
<td class="confluenceTd"> service </td>
<td class="confluenceTd"> QName </td>
<td class="confluenceTd"> the QName of the target service. One of service or interface attribute is required </td>
</tr>
<tr>
<td class="confluenceTd"> endpoint </td>
<td class="confluenceTd"> String </td>
<td class="confluenceTd"> the name of the target JBI endpoint, only used when service is set </td>
</tr>
</tbody></table>

<p>If you want to target a given interface, just set the interface attribute.  Else you have to set the service attribute, and optionally the endpoint attribute if you want to specify the JBI endpoint instead of a service name.</p>

</div><div class="section_3"><h3><a name="servicemix-eip-NamespaceContext"></a>NamespaceContext</h3>

<p>Some patterns use XPath expression.  To use such expressions on an xml with namespaces, you need to define a NamespaceContext.</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;eip:namespace-context id=<span class="code-quote">"nsContext"</span>&gt;</span>
  <span class="code-tag">&lt;eip:namespaces&gt;</span>
    <span class="code-tag">&lt;eip:namespace prefix=<span class="code-quote">"test"</span>&gt;</span>http://test<span class="code-tag">&lt;/eip:namespace&gt;</span>
  <span class="code-tag">&lt;/eip:namespaces&gt;</span>
<span class="code-tag">&lt;/eip:namespace-context&gt;</span></pre>
</div></div>
<p>This NamespaceContext can be referenced by a <b>namespaceContext</b> attribute as shown in the XPathSplitter or MessageFilter examples.</p>

</div><div class="section_3"><h3><a name="servicemix-eip-Predicates"></a>Predicates</h3>

<p>Some patterns uses predicates to test a given JBI exchange.  The only predicate currently implemented is the XPathPredicate, but you can implement your own and deploy it with the service unit.</p>

<p>TODO: link to a page documenting the classpath / location elements for deploying code inside xbean SU</p>
</div></div></div>
        </div>
<div style="text-align: center; width: 100%; padding-top: 1cm;padding-bottom: 1cm">


</div>
</td>
    <tr>
    <tr id="ulayout_bottom">
      <td colspan="2" id="ufooter">
        <div class="content">
          
          
          <div>
            <a class="editPage" href="http://docs.codehaus.org/pages/editpage.action?spaceKey=SM&amp;title=servicemix-eip"><img src="http://www.codehaus.org/edit.gif" border="0">[&nbsp;edit&nbsp;]</a>
          </div>
        </div>
      </td>
    </tr>
  </table>
</html>
