
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
  <HEAD>
<!--
    Pier's plugin always overwrites the stylesheet so lets explicitly use another one
    <link type="text/css" rel="stylesheet" href="autoexport:///SM/resources/space.css">
-->
    <LINK type="text/css" rel="stylesheet" href="resources/site.css">
    <SCRIPT src="resources/space.js" type="text/javascript"></SCRIPT>
    <SCRIPT src="http://www.google-analytics.com/urchin.js" type="text/javascript">
    </SCRIPT>
    <SCRIPT type="text/javascript">
_uacct = "UA-398545-1";
urchinTracker();
    </SCRIPT>
    <TITLE>
Working with Components
    </TITLE>
  <META http-equiv="Content-Type" content="text/html;charset=UTF-8"></HEAD>
  <BODY onload="init()">

    <!-- Banner -->
    <DIV id="site-banner">

      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" class="topbardiv" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/servicemix/main/images/logo.jpg">
          </TD>
          <TD align="right" nowrap="">
            <IMG border="0" src="http://incubator.apache.org/images/apache-incubator-logo.png">
          </TD>
        </TR> 
      </TABLE>

    </DIV>

    <!-- Bread crumbs and Quick Links -->
    <DIV id="site-navbar">
      <TABLE border="0" cellpadding="0" cellspacing="0" width="100%">
        <TR>
          <TD align="left" valign="middle" nowrap="">
            <DIV id="site-breadcrumbs">
<A href="home.html" title="ServiceMix">ServiceMix</A>&nbsp;&gt;&nbsp;<A href="home.html" title="Home">Home</A>&nbsp;&gt;&nbsp;<A href="documentation.html" title="Documentation">Documentation</A>&nbsp;&gt;&nbsp;<A href="tooling-and-utilities.html" title="Tooling and Utilities">Tooling and Utilities</A>&nbsp;&gt;&nbsp;<A href="maven-jbi-plugin.html" title="Maven JBI plugin">Maven JBI plugin</A>&nbsp;&gt;&nbsp;<A href="" title="Working with Components">Working with Components</A>
            </DIV>
          </TD>
          <TD align="right" valign="middle" nowrap="">
            <DIV id="site-quicklinks">
<P><A href="download.html" title="Download">Download</A> &#124; <A href="documentation.html" title="Documentation">Documentation</A> &#124; <A href="javadocs.html" title="JavaDocs">JavaDocs</A> &#124; <A href="source.html" title="Source">Source</A> &#124; <SPAN class="nobr"><A href="home.html" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN> &#124; <A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A> &#124; <A href="support.html" title="Support">Support</A></P>
            </DIV>
          </TD>
        </TR> 
      </TABLE>
    </DIV>

<!-- Integrate google search later.
          <form name="search" action="http://www.google.com/search" method="get">
            <input type="hidden" name="ie" value="UTF- 8" />
            <input type="hidden" name="oe" value="UTF- 8" />
            <input type="hidden" name="domains" value="" />
            <input type="hidden" name="sitesearch" value="" />
            <input type="text" name="q" maxlength="255" value="" />        
            <input type="submit" name="btnG" value="Google Search" />
          </form>
-->

      <DIV id="site-content">
        <TABLE>
        <TR>
        <TD valign="top">
          <DIV id="site-navigation">
<H3><A name="Navigation-Overview"></A>Overview</H3>

<UL class="alternate" type="square">
	<LI><A href="home.html" title="Home">Home</A></LI>
	<LI><SPAN class="nobr"><A href="http://www.apache.org/" title="Visit page outside Confluence" rel="nofollow">ASF<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="license.html" title="License">License</A></LI>
	<LI><A href="faq.html" title="FAQ">FAQ</A></LI>
	<LI><A href="download.html" title="Download">Download</A></LI>
	<LI><A href="sitemap.html" title="SiteMap">SiteMap</A></LI>
</UL>


<H3><A name="Navigation-Community"></A>Community</H3>

<UL class="alternate" type="square">
	<LI><A href="users-guide.html" title="User's Guide">User&apos;s Guide</A></LI>
	<LI><A href="documentation.html" title="Documentation">Documentation</A></LI>
	<LI><A href="support.html" title="Support">Support</A></LI>
	<LI><A href="discussion-forums.html" title="Discussion Forums">Discussion Forums</A></LI>
	<LI><A href="mailing-lists.html" title="Mailing Lists">Mailing Lists</A></LI>
	<LI><SPAN class="nobr"><A href="http://issues.apache.org/activemq/browse/SM" title="Visit page outside Confluence" rel="nofollow">Issues<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="contributing.html" title="Contributing">Contributing</A></LI>
	<LI><SPAN class="nobr"><A href="http://goopen.org/confluence/pages/listpages-dirview.action?key=SM" title="Visit page outside Confluence" rel="nofollow">Wiki<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN></LI>
	<LI><A href="team.html" title="Team">Team</A></LI>
	<LI><A href="users.html" title="Users">Users</A></LI>
</UL>


<H3><A name="Navigation-Developers"></A>Developers</H3>

<UL class="alternate" type="square">
	<LI><A href="source.html" title="Source">Source</A></LI>
	<LI><A href="building.html" title="Building">Building</A></LI>
	<LI><A href="ideas.html" title="Ideas">Ideas</A></LI>
	<LI><A href="becoming-a-committer.html" title="Becoming a committer">Becoming a committer</A></LI>
	<LI><A href="release-guide.html" title="Release Guide">Release Guide</A></LI>
	<LI><A href="related-projects.html" title="Related Projects">Related Projects</A></LI>
	<LI><A href="tools.html" title="Tools">Tools</A></LI>
	<LI><A href="resources.html" title="Resources">Resources</A></LI>
</UL>


<H3><A name="Navigation-Components"></A>Components</H3>

<UL class="alternate" type="square">
	<LI><A href="servicemix-bean.html" title="servicemix-bean">servicemix&#45;bean</A></LI>
	<LI><A href="servicemix-bpe.html" title="servicemix-bpe">servicemix&#45;bpe</A></LI>
	<LI><A href="servicemix-drools.html" title="servicemix-drools">servicemix&#45;drools</A></LI>
	<LI><A href="servicemix-eip.html" title="servicemix-eip">servicemix&#45;eip</A></LI>
	<LI><A href="servicemix-file.html" title="servicemix-file">servicemix&#45;file</A></LI>
	<LI><A href="servicemix-ftp.html" title="servicemix-ftp">servicemix&#45;ftp</A></LI>
	<LI><A href="servicemix-http.html" title="servicemix-http">servicemix&#45;http</A></LI>
	<LI><A href="servicemix-jms.html" title="servicemix-jms">servicemix&#45;jms</A></LI>
	<LI><A href="servicemix-jsr181.html" title="servicemix-jsr181">servicemix&#45;jsr181</A></LI>
	<LI><A href="servicemix-lwcontainer.html" title="servicemix-lwcontainer">servicemix&#45;lwcontainer</A></LI>
	<LI><A href="servicemix-saxon.html" title="servicemix-saxon">servicemix&#45;saxon</A></LI>
	<LI><A href="servicemix-script.html" title="servicemix-script">servicemix&#45;script</A></LI>
	<LI><A href="servicemix-wsn2005.html" title="servicemix-wsn2005">servicemix&#45;wsn2005</A></LI>
	<LI><A href="servicemix-xmpp.html" title="servicemix-xmpp">servicemix&#45;xmpp</A></LI>
</UL>


          </DIV>
        </TD>
        <TD valign="top">
          <DIV id="site-page">

<!--          
            <div class="pagetitle">Working with Components</div>
-->
            <DIV class="wiki-content"><P>JBI logically separates Binding Components and Service Engines as two flavours of a component,  the Maven JBI tooling provides that you can define a project as a <B>jbi-component</B> and then specify whether it is a service-engine or binding-component.  Like the shared libraries we have just covered the definition of a jbi-component firstly requires the steps from <A href="maven-jbi-plugin.html#MavenJBIplugin-GettingStarted" title="Getting Started on Maven JBI plugin">Getting Started</A> (plugin repositories and plugin) and then it also requires you change the packaging of your project.</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml">&lt;project xmlns=<SPAN class="code-quote">&quot;http://maven.apache.org/POM/4.0.0&quot;</SPAN> <SPAN class="code-keyword">xmlns:xsi</SPAN>=<SPAN class="code-quote">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</SPAN>
  xsi:schemaLocation=<SPAN class="code-quote">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;</SPAN>&gt;
  <SPAN class="code-tag">&lt;modelVersion&gt;</SPAN>4.0.0<SPAN class="code-tag">&lt;/modelVersion&gt;</SPAN>
  <SPAN class="code-tag">&lt;groupId&gt;</SPAN>org.apache.servicemix<SPAN class="code-tag">&lt;/groupId&gt;</SPAN>
  <SPAN class="code-tag">&lt;artifactId&gt;</SPAN>MyBindingComponent<SPAN class="code-tag">&lt;/artifactId&gt;</SPAN>
  <SPAN class="code-tag">&lt;packaging&gt;</SPAN>jbi-component<SPAN class="code-tag">&lt;/packaging&gt;</SPAN>
  <SPAN class="code-tag">&lt;version&gt;</SPAN>1.0-SNAPSHOT<SPAN class="code-tag">&lt;/version&gt;</SPAN>
  <SPAN class="code-tag">&lt;name&gt;</SPAN>An example binding component<SPAN class="code-tag">&lt;/name&gt;</SPAN>
  ...
<SPAN class="code-tag">&lt;/project&gt;</SPAN></PRE>
</DIV></DIV>
<P>Since a binding component or service engine has more settings than can be derived from your Maven POM.xml we also need to update the plugin section we added to configure these additional settings:</P>
<DIV class="code"><DIV class="codeContent">
<PRE class="code-xml"><SPAN class="code-tag">&lt;plugin&gt;</SPAN>
  <SPAN class="code-tag">&lt;groupId&gt;</SPAN>org.apache.servicemix.tooling<SPAN class="code-tag">&lt;/groupId&gt;</SPAN>
  <SPAN class="code-tag">&lt;artifactId&gt;</SPAN>jbi-maven-plugin<SPAN class="code-tag">&lt;/artifactId&gt;</SPAN>
  <SPAN class="code-tag">&lt;extensions&gt;</SPAN>true<SPAN class="code-tag">&lt;/extensions&gt;</SPAN>
  <SPAN class="code-tag">&lt;configuration&gt;</SPAN>
    <SPAN class="code-tag">&lt;type&gt;</SPAN>binding-component<SPAN class="code-tag">&lt;/type&gt;</SPAN>
    <SPAN class="code-tag">&lt;bootstrap&gt;</SPAN>org.apache.servicemix.MyBootstrap<SPAN class="code-tag">&lt;/bootstrap&gt;</SPAN>
    <SPAN class="code-tag">&lt;component&gt;</SPAN>org.apache.servicemix.MyComponent<SPAN class="code-tag">&lt;/component&gt;</SPAN>
  <SPAN class="code-tag">&lt;/configuration&gt;</SPAN>
<SPAN class="code-tag">&lt;/plugin&gt;</SPAN></PRE>
</DIV></DIV>
<P>The parameters allow you to specify the following :</P>

<P><B>type</B> &#45; whether this is a binding-component or a service-engine<BR>
<B>bootstrap</B> &#45; the name of the class that will be your bootstrap implementation<BR>
<B>component</B> &#45; the name of the class that will be your component implementation</P>

<TABLE cellpadding="5" width="85%" cellspacing="8px" class="tipMacro" border="0" align="center"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><IMG src="http://goopen.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD><B class="strong">Using a Default Bootstrap</B><BR>
<P>Often when you build a new component you don&apos;t need the bootstrap class and end up simply having to create a class to fulfill the specification.  However,  with the Maven JBI tooling you can simply not specify a bootstrap in your configuration for the plugin and the plugin will copy the DefaultBootstrap from the servicemix-common project (which basically just implements the interface) into you project and will correctly reference this in the jbi.xml.  This is because the service-common shared-library is not available to the classloader for bootstrapping.</P></TD></TR></TABLE>

<P>Once you have configured these steps you can run <EM>mvn install</EM> and much like the shared library maven will create both a standard jar and also a component installer.&nbsp; If you have a locally running Apache ServiceMix instance (which its default settings) you can even use the plugin to install the Component by simply typing:</P>

<P><EM>mvn jbi:installComponent</EM></P>

<P>This will call the ANT tasks from within Maven giving the component to install as the one built in the install phase.</P>

<H3><A name="WorkingwithComponents-ServiceUnitAnalyzers%26nbsp%3B"></A>Service Unit Analyzers&nbsp;</H3>

<P>One of the aspects of packaging of Service Unit is providing the services element of the jbi.xml,&nbsp; this is an element that contains consumes and provides (to show the services that will be used or exposed).&nbsp; The JBI tooling has been extended to allow a component to intercept the construction of a service unit (for that component) in order to &quot;analyze&quot; the service unit and thus create the consumes and provides.</P>

<P>The exact mechanism for a component determining the consumes and provides for a service unit is dependent on the component and how it handles service units,&nbsp; however the tooling does provide that a component can provide the configuration element <B>serviceUnitAnalyzer</B> this will refer to a classname within the component package.</P>

<P>The class defined in the serviceUnitAnalyzer needs to implement the interface <SPAN class="nobr"><A href="http://svn.apache.org/repos/asf/incubator/servicemix/trunk/servicemix-common/src/main/java/org/apache/servicemix/common/packaging/ServiceUnitAnalyzer.java" title="Visit page outside Confluence" rel="nofollow">ServiceUnitAnalyzer <SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN>which is defined in the servicemix-common jar,&nbsp; it has a simple init method which is called and passed the exploed (source) service unit and then methods that it returns a list of <SPAN class="nobr"><A href="http://svn.apache.org/repos/asf/incubator/servicemix/trunk/servicemix-common/src/main/java/org/apache/servicemix/common/packaging/Consumes.java" title="Visit page outside Confluence" rel="nofollow">Consumes <SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN>and <SPAN class="nobr"><A href="http://svn.apache.org/repos/asf/incubator/servicemix/trunk/servicemix-common/src/main/java/org/apache/servicemix/common/packaging/Provides.java" title="Visit page outside Confluence" rel="nofollow">Provides<SUP><IMG class="rendericon" src="http://goopen.org/confluence/images/icons/linkext7.gif" height="0" width="0" align="absmiddle" alt="" border="0"></SUP></A></SPAN>.&nbsp; This informaiton is taken and used by the JBI plugin during the creation of the service unit for the component to add in consumes and provides.&nbsp; While this information isn&apos;t needed for the JBI specification is it key to providing core information for tooling. </P></DIV>
          
                  </DIV>
        </TD>
      </TR>
      </TABLE>     
      </DIV>
    </DIV>
    <DIV id="site-footer">
          Added by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=philip.dodds%2540gmail.com">Philip Dodds</A>,
    last edited by     <A href="http://goopen.org/confluence/users/viewuserprofile.action?username=philip.dodds%2540gmail.com">Philip Dodds</A> on Oct 03, 2006
                  &nbsp;(<A href="http://goopen.org/confluence/pages/diffpages.action?pageId=8918&originalId=13932">view change</A>)
              
      (<A href="http://goopen.org/confluence/pages/editpage.action?pageId=8918">edit page</A>)
    </DIV>

  </BODY>

</HTML>